<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="ja">
<head>
<!-- Generated by javadoc (1.8.0_152) on Wed Oct 21 20:53:12 JST 2020 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>hiMongo</title>
<meta name="date" content="2020-10-21">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="hiMongo";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":9,"i1":9,"i2":9,"i3":9,"i4":9,"i5":9,"i6":9,"i7":9,"i8":9,"i9":9,"i10":9,"i11":9,"i12":9,"i13":9,"i14":9,"i15":9,"i16":9,"i17":9,"i18":9,"i19":9,"i20":9,"i21":9,"i22":9,"i23":9,"i24":9,"i25":9,"i26":9,"i27":9,"i28":9,"i29":9,"i30":9};
var tabs = {65535:["t0","すべてのメソッド"],1:["t1","staticメソッド"],8:["t4","concreteメソッド"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>ブラウザのJavaScriptが無効になっています。</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="ナビゲーション・リンクをスキップ">ナビゲーション・リンクをスキップ</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="ナビゲーション">
<li><a href="../../hi/db/package-summary.html">パッケージ</a></li>
<li class="navBarCell1Rev">クラス</li>
<li><a href="package-tree.html">階層ツリー</a></li>
<li><a href="../../deprecated-list.html">非推奨</a></li>
<li><a href="../../index-all.html">索引</a></li>
<li><a href="../../help-doc.html">ヘルプ</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>前のクラス</li>
<li><a href="../../hi/db/hiMongo.Accessor.html" title="hi.db内のインタフェース"><span class="typeNameLink">次のクラス</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?hi/db/hiMongo.html" target="_top">フレーム</a></li>
<li><a href="hiMongo.html" target="_top">フレームなし</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses-noframe.html">すべてのクラス</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>サマリー:&nbsp;</li>
<li><a href="#nested.class.summary">ネスト</a>&nbsp;|&nbsp;</li>
<li>フィールド&nbsp;|&nbsp;</li>
<li>コンストラクタ&nbsp;|&nbsp;</li>
<li><a href="#method.summary">メソッド</a></li>
</ul>
<ul class="subNavList">
<li>詳細:&nbsp;</li>
<li>フィールド&nbsp;|&nbsp;</li>
<li>コンストラクタ&nbsp;|&nbsp;</li>
<li><a href="#method.detail">メソッド</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">hi.db</div>
<h2 title="クラス hiMongo" class="title">クラス hiMongo</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>hi.db.hiMongo</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">hiMongo</span>
extends <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a></pre>
<div class="block">mongoDBアクセス機.
<!--
JDOCに関する注意点：<,>はconv -with propJ.txtでエスケープしますので&lt;化は不要です。
-->
<pre id="top" class=quote10 style="background-color:black;color:#eeffff">

 // JAVAプログラム
 hiMongo.DB db=hiMongo.use("db01");   // database   選択
 db.in("coll_01")                    // collection 選択
   .find("{type:'A'}","{_id:0}")      // typeが'A'のレコード
   .sort("{_id:-1}")                  // _idで逆向きにソート
   .limit(3)                          // 個数制限
   .getJsonList(hiU.REVERSE)          // 反転したリスト取得
   .forEach(Rd-&gt;System.out.println(Rd));// レコード表示

</pre>

<p>
hiMongoはドキュメント指向のDataBaseであるmongoDBにアクセスするjavaライブラリです。<br>
hiMongoはmongo-java-driverのラッパーです。
</p>
<hr>
<ul>
<li><a class=A1 href="#hiMongo_base">JavaでmongoDB;hiMongo基本</a>
   <ul>
   <li><a class=A1 href="#mongoDB">mongoDBとは</a>
   <li><a class=A1 href="#api_find">hiMongo-APIの基本;レコード取得</a>
   <li><a class=A1 href="#api_insert">hiMongo-APIの基本;レコード挿入</a>
   <li><a class=A1 href="#api_cascade">hiMongo-APIの基本;カスケード式</a>
   </ul>
</li>
<li><a class=A1 href="#find">find(検索)の引数と結果</a>
   <ul>
   <li><a class=A1 href="#getDocument">Documentで取得</a>
   <li><a class=A1 href="#getClass">利用者定義クラス・インスタンスとして取得</a>
   <li><a class=A1 href="#getProbe">汎用データ探索機hiJSON.Probeで取得</a>
   <li><a class=A1 href="#getJsonMson">JSON文字列、拡張JSON文字列で取得</a>
   </ul>
</li>
<li><a class=A1 href="#insert_and_others">insert等のレコード処理</a>
   <ul>
   <li><a class=A1 href="#col_insert">insert</a>
   <li><a class=A1 href="#col_drop">drop</a>
   <li><a class=A1 href="#col_delete">delete</a>
   <li><a class=A1 href="#col_update">update</a>
   <li><a class=A1 href="#col_replace">replace</a>
   <li><a class=A1 href="#class_insert">利用者定義クラス・インスタンスをinsertする</a>
   </ul>
</li>
<li><a class=A1 href="#cap_index">cap指定（最大容量)、index設定</a>
   <ul>
   <li><a class=A1 href="#cap">キャップ指定</a></li>
   <li><a class=A1 href="#index">インデックス指定,ユニーク性保証,生存時間制限</a></li>
   </ul>
</li>
<li><a class=A1 href="#AG">aggregate(集計）</a>
   <ul>
   <li><a class=A1 href="#aggre">単純集計($match,$group)</a></li>
   <li><a class=A1 href="#lookup">$lookupによるフィールド結合</a></li>
   </ul>
</li>
<li><a class=A1 href="#mson">mongoDB拡張JSON(mson)記述</a>
   <ul>
   <li><a class=A1 href="#quote">引用符</a>
   <li><a class=A1 href="#date">ObjectId,Dateと数値</a>
   <!--<li><a class=A1 href="#regex">正規表現</a>-->
   <li><a class=A1 href="#comment">コメント等のhiMongo拡張(hson)</a>
   </ul>
</li>
<li><a class=A1 href="#remote">remote接続</a></li>
<li><a class=A1 href="#worker">Caller(API)とWorker(deiver呼び出し)</a></li>
<!--
<li><a class=A1 href="#driver">driver-APIを使う</a></li>
<li><a class=A1 href="#node">node(Object,Document)の取り扱い</a></li>
-->
<li><a class=A1 href="#build">build</a></li>
<li><a class=A1 href="#log">log</a></li>
<li><a class=A1 href="#version">更新履歴</a></li>
<li><a class=A1 href="#API">API</a></li>
</ul>


<hr>
<table style="line-height:100%" class=t0>
<tr><td colspan=2>用語:</td></tr>
<tr><td>mson</td><td>: mongoDB用の拡張JSON記述;ObjectId(...),ISODate(...)あり</td><tr>
<tr><td>json</td><td>: 標準JSON記述</td><tr>
<tr><td>hson</td><td>: msonにコメント等の入力解析拡張を行ったもの</td><tr>
<tr><td>Database</td><td>: データベース。名前付きcollectionの集合</td><tr>
<tr><td>Collection</td><td>: レコードの集合</td><tr>
<tr><td>レコード</td><td>: 入出力データの基本単位,名前付きフィールドの集合</td><tr>
<tr><td>フィールド</td><td>: レコード内の名前付きの値</td><tr>
<tr><td>ノード</td><td>: プログラム上でのデータ要素。データはノードのツリー構造となる</td><tr>
<tr><td>Document</td><td>: プログラムでのmsonのノード実装クラスおよびノードデータ<br>
mongoDBではレコードの事を'ドキュメント'と呼ぶとされているが、ここではプログラム上で限定される<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース"><code>Document</code></a>クラスを指す</td></tr>
<tr><td>bson</td><td>: msonのバイナリ表現(プログラム上およびDB上)<br>
<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/conversions/Bson.html?is-external=true" title="org.bson.conversions内のクラスまたはインタフェース"><code>Bson</code></a>クラスはJSON式の構造は採っておらず、hiMongoでは対象外としています。
</td><tr>
<!-- memo: a内のrel="noopener noreferrer"はjava8神経質jdocエラーとなる -->
<tr><td>
hiJSON
</td><td>:hiMongoが使用している
<a class=A1 target="_blank" rel="noopener noreferrer" href=
"http://www.otsu.co.jp/OtsuLibrary"
><i>Otsu</i>ラリブラリ(エントリ)
</a>
/
<a class=A1 target="_blank" rel="noopener noreferrer" href=
"http://www.otsu.co.jp/OtsuLibrary/jdoc/index.html"
>hiNoteパッケージ
</a>
に属するクラスです。
<td></tr>
</table>
<hr>

<a class=A1 href="#top">top</a>、<a class=A1 href="#API">API</a>
<p class=B1 id="hiMongo_base">
&emsp;JavaでmongoDB;hiMongoの基本
</p>
<p class=B1_2 id="mongoDB">
&emsp;mongoDBとは
</p>
<div id="divMongoDB_1">
<p><input type="button" value="説明を表示する" style="WIDTH:12em"
   onClick="document.getElementById('divMongoDB_2').style.display='block';
            document.getElementById('divMongoDB_1').style.display='none'"></p>
</div>
<div id="divMongoDB_2" style="display:none">
<p><input type="button" value="説明を隠す" style="WIDTH:12em"
   onClick="document.getElementById('divMongoDB_2').style.display='none';
            document.getElementById('divMongoDB_1').style.display='block'"></p>
<p>
mongoDBはドキュメント指向DBです。SQLで扱うテーブル指向のリレーショナルDBとは異なるアプローチを採っています。
</p>
<p class=c>
&emsp;データモデル、階層
</p>
<p>
mongoDBでは次のようにデータがモデル化されます。
</p>
<pre class=prog10>
データベース(名前付き)
|
+-- コレクション(名前付き)
    |
    +-- レコード        概念上JSON文字列で表現される。
        |                  {"フィールド名":値、"フィールド名":値・・・}
        |
        +-- フィールド(名前付き)  jsonの一要素　中にさらにjson構造を含んでも良い
                                  名前と値で構成される
                                  "_id"という名称のデフォルトのフィールドがある
                                  "_id"値は通常重複が無い形で自動生成される
</pre>
<p>
レコードの形式を限定するスキーマはなく、内容はJSON形式に表せるものであれば何でも構いません。<br>
レコードには名前は付きません。フィールド値を指定して検索できます。<br>
mongoDBではレコードをDocumentと呼びますが、ここではコレクションに含まれる単位をレコードと呼びます。
</p>
<p>
コレクションはレコードの集合です。通常はコレクション中のレコードは同じ形式を与えます。ただし、そのような制限がある訳ではありません。
</p>
<p>
次のような形となります。
</p>
<pre class=prog10>
データベース "db01"
+-- コレクション "coll_A"
|   +-- {value1:'A' ,value2:1.57 ,value3:true <span class=gray>,_id:'????'</span>}
|   +-- {value1:'C' ,value2:3.78 ,value3:false<span class=gray>,_id:'????'</span>}
|   +-- {value1:'XX',value2:0    ,value3:true <span class=gray>,_id:'????'</span>}
|   +-- {value1:'Y' ,value2:2e326,value3:true <span class=gray>,_id:'????'</span>}
+-- コレクション "coll_X"
    +-- {name:'佐藤',age:50,趣味:'ゴルフ'  <span class=gray>,_id:'????'</span>}
    +-- {name:'田中',age:25,趣味:'音楽鑑賞'<span class=gray>,_id:'????'</span>}
    +-- {name:'鈴木',age:30,趣味:'読書'    <span class=gray>,_id:'????'</span>}
（_idは利用者が意識して挿入したものではありません）
</pre>
<p>
データ表現はJSONを基本とし、引用符などを取り扱いやすいものにしてあります。
</p>

<p class=c>
&emsp;レコード検索と挿入
</p>
<p>
レコードの取得には
</p>
<ul>
<li>検索条件</li>
<li>取得するフィールド</li>
</ul>
<p>
をJSON形式で指定します。
</p>
<pre class=prog10>
    .find("{val_n:'A'}","{_id:0,val_n:1,val_01:1}")
    //     検索条件      取得するフィールド
</pre>
<p>
条件はJSON形式です。
</p>
<pre class=prog10>
   { フィールド名:値 }
</pre>
<p>
の形です。
</p>
<p>
値は単純値の他、大小や正規表現条件を付加することが出来ます。
(<a class=A1 href="#compare">フィールド値の大小判断</a>参照)
</p>
<pre class=prog10>
  { val_01        : { $gt : 100} }
  // フィル―ド名 : 値（100より大きい)
  //                大なり: 数値
</pre>
<p>
論理積(and)論理和(or)で複数の条件を組み合わせることも出来ます。
(<a class=A1 href="#logic_ope">条件の組み合わせ</a>参照)
</p>
<pre class=prog10>
   { $and : [ // 配列で要素並びを設定する
        { val_n : 'A' },        // val_nフィールドの値が'A'
        { val_01 : {$gt : 100} }// かつval_01フィールドの値が100以上
        ]}
</pre>
<p>
取得するフィールドはフィールド名に値１または０で取得、取得しないを示します。
</p>
<pre class=prog10>
   { _id:0,val_01:0 } // _idフィールドとval_01フィールド以外を取得する。
</pre>
<p>
_idフィールドと他フィールドの扱いは異なっています。
<a class=A1 href="#get_fileld">取得フィールド</a>を参照してください。
</p>
<p>
レコードの追加にはレコード情報のJSON形式を与えます。
</p>
<pre class=prog10>
   .insertOne("{name:'佐藤',age:50,趣味:'ゴルフ'}");
</pre>
<p>
_idフィールドは自動で付加されます。
</p>

<p class=c>
&emsp;システム構成；サーバとクライアント
</p>
<p>
mongoDBはサーバとクライアント構成をとります。
</p>
<p>
サーバはクライアントプログラムと同じ装置でもリモート装置でも構いません。
</p>
<p>
クライアント側は用意されているドライバを用いアプリケーションプログラムを作成しアクセスする他、mongo-shellとよぶCUIプログラム(mongo)で端末から対話式にアクセスすることも出来ます。<br>
本ライブラリはクライアントプログラムを作成するためのものです。
</p>



<p class=c>
&emsp;制限
</p>
<p>
mongoDBは精密なスキーマ設計を行うことなく、簡便にDBを構築できます。
</p>
<p>
ある程度複雑な検索を行うことが出来ます。<br>
フィールド値をアトミックに増減させる機能も用意されています。<br>
現実的DB応用の広い範囲で利用できると考えられますし、リレーショナル・データベースに比べ高速であるため巨大な通信バッファのような応用も出来ます。
</p>
<p>
ただしコレクション間の連携処理は弱く、サブクエリといったものも用意されていません。<br>
必要な場合プログラムによる手続きによって実現することになります。
</p>
<p>
また、トランザクション機能を持たないことも注意すべき点です。
</p>
<p>
なお、最も気を付ける必要があるのが「名称を間違えると新たな要素の追加となる」という仕様です。フィールド値をupdateしたつもりが新なフィールドの追加となったといった障害が多発します。
</p>

<p><input type="button" value="説明を隠す△" style="WIDTH:12em"
   onClick="document.getElementById('divMongoDB_2').style.display='none';
            document.getElementById('divMongoDB_1').style.display='block';
            document.location='#divMongoDB_1'"></p>
</div>



<p class=B1_2 id="api_find">
&emsp;JavaでmongoDB;hiMongo-APIの基本;レコード取得
</p>
<p>
次のプログラムはJava用のmongoDBライブラリhiMongoの使用例です。
</p>
<pre class=quote10>
 // JAVAプログラム
 <a href="../../hi/db/hiMongo.DB.html" title="hi.db内のインタフェース"><code>hiMongo.DB</code></a> db=<a href="../../hi/db/hiMongo.html#use-java.lang.String-"><code>hiMongo.use("db01")</code></a>;   // database   選択
 db<a href="../../hi/db/hiMongo.DB.html#in-java.lang.String-"><code>.in("coll_01")</code></a>                    // collection 選択
   <a href="../../hi/db/hiMongo.Collection.html#find-java.lang.Object-java.lang.Object-"><code>.find("{type:'A'}","{_id:0}")</code></a>      // typeが'A'のレコード
   <a href="../../hi/db/hiMongo.Finder.html#sort-java.lang.Object-"><code>.sort("{_id:-1}")</code></a>                  // _idで逆向きにソート
   <a href="../../hi/db/hiMongo.Finder.html#limit-int-"><code>.limit(3)</code></a>                          // 個数制限
   <a href="../../hi/db/hiMongo.Accessor.html#getJsonList-long-"><code>.getJsonList(hiU.REVERSE)</code></a>          // 反転したリスト取得
   <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Iterable.html?is-external=true#forEach-java.util.function.Consumer-" title="java.lang内のクラスまたはインタフェース"><code>.forEach(Rj-&gt;System.out.println(Rj))</code></a>;// レコード表示
</pre>
<p>
mongoDBのCUIであるmongo-shellの次の手続きに相当します。
</p>
<pre class=quote10>
 // mongo shell script
 use db01;
 db.coll_01.                             // collection 選択
    find({type:'A'},{_id:0}).            // typeが'A'のレコード
    sort({_id:-1}).                      // _idで逆向きにソート
    limit(3).                            // 個数制限
    toArray().reverse().                 // 反転したリスト取得
    forEach(Rd=&gt;print(JSON.stringify(Rd)));// 要素表示
</pre>
<p>
typeフィールドが'A'であるレコードの最新３個を取得しています。
</p>
<p>
実際にビルド・実行できるフルコードと実行結果を示します
</p>
<div id="divSimple_1">
<p><input type="button" value="フルコードを表示する" style="WIDTH:12em"
   onClick="document.getElementById('divSimple_2').style.display='block';
            document.getElementById('divSimple_1').style.display='none'"></p>
</div>
<div id="divSimple_2" style="display:none">
<p><input type="button" value="フルコードを隠す" style="WIDTH:12em"
   onClick="document.getElementById('divSimple_2').style.display='none';
            document.getElementById('divSimple_1').style.display='block'"></p>
<pre class=quote8>
// このプログラムではtypeフィールドが'A'のレコードの最新３個を表示しています
// sort({_id-1})で一旦並びを逆にしていますので、リストは再反転して取得します
// ここではmongo-shellの出力形式と揃えるためgetMsonListを使っています
import hi.db.hiMongo;
import otsu.hiNote.*;
public class Test {
   public static void main(String[] args_){
      hiMongo.DB db=hiMongo.use("db01");  // database   'db01'選択
      db.in("coll_01")                     // collection 選択
        .find("{type:'A'}","{_id:0}")      // typeが'A'のレコード,
        .sort("{_id:-1}")                  // _idで逆向きにソート
        .limit(3)                          // 個数制限
        .getMsonList(hiU.REVERSE)          // 反転したリスト取得
        .forEach(Rm-&gt;System.out.println(Rm)) // レコード表示
        ;
      }
   }
＊＊＊＊＊＊　dbデータ
&gt; use db01
switched to db db01
&gt; db.coll_01.find({},{_id:0})
{ "type" : "A", "value" : 12.3, "date" : ISODate("2020-08-17T07:07:00Z") }
{ "type" : "A", "value" : 4.56, "date" : ISODate("2020-08-17T07:07:10Z") }
{ "type" : "B", "value" : 2001, "date" : ISODate("2020-08-17T07:07:20Z") }
{ "type" : "A", "value" : 7.89, "date" : ISODate("2020-08-17T07:07:30Z") }
{ "type" : "A", "value" : 0.12, "date" : ISODate("2020-08-17T07:07:40Z") }
＊＊＊＊＊＊　ビルド実行結果
$ ./run.sh
----- 01simpleAccess -----
{"type":"A", "value":4.56, "date":ISODate("2020-08-17T07:07:10.000Z")}
{"type":"A", "value":7.89, "date":ISODate("2020-08-17T07:07:30.000Z")}
{"type":"A", "value":0.12, "date":ISODate("2020-08-17T07:07:40.000Z")}
OK
</pre>
<p><input type="button" value="フルコードを隠す△" style="WIDTH:12em"
   onClick="document.getElementById('divSimple_2').style.display='none';
            document.getElementById('divSimple_1').style.display='block';
            document.location='#div_1'"></p>
</div>
<p>
本文書に掲載するプログラムおよびプログラムの断片は次の習慣に沿って書かれています。
</p>
<div id="divCoding_1">
<p><input type="button" value="説明を表示する" style="WIDTH:12em"
   onClick="document.getElementById('divCoding_2').style.display='block';
            document.getElementById('divCoding_1').style.display='none'"></p>
</div>
<div id="divCoding_2" style="display:none">
<p><input type="button" value="説明を隠す" style="WIDTH:12em"
   onClick="document.getElementById('divCoding_2').style.display='none';
            document.getElementById('divCoding_1').style.display='block'"></p>

<p class=c>
&emsp;変数名;dbは例外
</p>
<p>
変数名は次の様に付けられます。
</p>
<table class=t0>
<tr>
<td style="width:8em">ローカル変数</td><td style="width:7em">先頭に_</td><td><pre class=prog10>MyRecord _rec=null;</pre></td>
</tr>
<tr>
<td>メソッド引数</td><td>最後に_</td><td><pre class=prog10>void func(String&emsp;arg_){...}</pre></td>
</tr>
<tr>
<td>クラス変数</td><td>_は付けない</td><td><pre class=prog10>class MyClass{String type,double value,Date date}</pre></td>
</tr>
</table>
<p>
例外："db"は例外的にローカル変数でも_を付加しません。ほぼ予約語に近い扱いとします。
</p>
<pre class=prog10>
    hiMongo.DB <span class=red>db</span>=hiMongo.use("db01");
</pre>

<p class=c>
&emsp;ラムダ式引数(hiMongoで扱う範囲のみ)
</p>
<p>
ラムダ式の引数名は大文字+小文字の2文字とします。<br>
データの表すものと型により次のように定めます。
</p>
<table class=t0>
<tr>
<td style="width:13em">レコードのDocument表現</td><td style="width:3em">Rd</td><td>forEachDocument(Rd-&gt;System.out.println(Rd))</td>
</tr>
<tr>
<td>レコードのClass表現&emsp;</td><td>Rc&emsp;</td><td>forEachClass(MyRecord.class,Rc-&gt;System.out.println(Rc.value))</td>
</tr>
<tr>
<td>レコードのProbe表現&emsp;</td><td>Rp&emsp;</td><td>forEachProbe(Rp-&gt;System.out.println(Rp.to("value").get())</td>
</tr>
<tr>
<td>レコードのJson表現&emsp;</td><td>Rj&emsp;</td><td>forEachJson(Rj-&gt;System.out.println(Rj))</td>
</tr>
<tr>
<td>レコードのMson表現&emsp;</td><td>Rm&emsp;</td><td>forEachMson(Rm-&gt;System.out.println(Rm))</td>
</tr>
<tr>
<td>Collection&emsp;</td><td>Co&emsp;</td><td>forThis(Co-&gt;System.out.println(Co.count())</td>
</tr>
<tr>
<td>Finder&emsp;</td><td>Fi&emsp;</td><td>forThis(Fi-&gt;Fi.getIterable().showRecordId(true))</td>
</tr>
<tr>
<td>Aggregator&emsp;</td><td>Ag&emsp;</td><td>forThis(Ag-&gt;System.out.println("some message"))</td>
</tr>
<tr>
<td>その他のDocumet&emsp;</td><td>Do&emsp;</td><td>getIndexList().forEach(Do-&gt;System.out.println(Do))</td>
</tr>
</table>

<p class=c>
&emsp;カスケード式のインデント
</p>
<p>
カスケード式では.を垂直にならべ、最後に.と同じ位置に終端子;を置きます。<br>
連続数が少ない場合は終端子は最終項の行端に置いても構いません。
</p>
<pre class=quote10>
      hiMongo.DB db=hiMongo.use("db01");
      db.in("coll_01")
        .find("{type:'A'}","{_id:0}")
        .sort("{_id:-1}")
        .limit(3)
        .getMsonList(hiU.REVERSE)
        .forEach(Rm-&gt;System.out.println(Rm)) // ;はここに置いても良い
        ;
        ^ 縦に揃える
</pre>
<p>
代入がある場合は変数と行を変え=を先頭に置きます。クラス変数アクセスは行を分けません。
</p>
<pre class=quote10>
      hiMongo.DB db=hiMongo.use("db01");
      long _last_date
      =db.in("coll_01")
         .find("{type:'A'}","{_id:0,date:1}")
         .sort("{_id:-1}").limit(1)
         .getClassList(WithDate.class)
         .get(0).date.getTime(); //クラス変数にアクセスする場合は行は分けない
</pre>

<p class=c>
&emsp;ブレイスとインデント
</p>
<p>
開始ブレイス{が有ると次の行を１インデント下げ、終了ブレイス}があると次の行を１インデント戻します。<br>
1インデントは３個の空白です。タブは厳禁です。<br>
この単純なルールによりif-elseやtry-catchなどの組が見やすくなります。
</p>
<pre class=quote10>
   if(...) {
      //...
      //...
      }
   else {
      //...
      //...
      }
   try{
      //...
      //..
      }
   catch(Exception _ex){
      //...
      }
</pre>

<p class=c>
&emsp;他
</p>
<p>
データのインデント、関数引数部のインデントなどは特に定めません。
</p>




<p><input type="button" value="説明を隠す△" style="WIDTH:12em"
   onClick="document.getElementById('divCoding_2').style.display='none';
            document.getElementById('divCoding_1').style.display='block';
            document.location='#divCoding_1'"></p>
</div>


<p class=B1_2 id="api_insert">
&emsp;APIの基本；レコード挿入
</p>
<p>
レコードの挿入では次の様にレコード内容を拡張JSON(mson)で与えます。
</p>
<pre class=quote10>
 // JAVAプログラム
 hiMongo.DB db=hiMongo.use("db01"));  // database   選択
 db.in("coll_01")                    // collection 選択
   <a href="../../hi/db/hiMongo.Collection.html#insertOne-java.lang.Object...-"><code>.insertOne("{type:'A',value:21,date:{$date:1597648050000}}")</code></a>;
</pre>
<p>
時刻は{$date:<i>Unix-Epoch</i>}またはISODate('<i>グリニッジ日時</i>')の形です。<br>
mongo-shellでは<b>new Date</b>(<i>Unix-Epoch</i>)またはISODate('<i>グリニッジ日時</i>')となります。
</p>
<pre class=quote10>
 // mongo-shell
use db01
db.coll_01.
   insertOne({type:'A',value:21,date:<b>new Date</b>(1597648050000)});
</pre>
</p>
<p class=B1_2 id="api_cascade">
&emsp;APIの基本；カスケード式
</p>
<p>
次のようなAPIが用意されており、冒頭のようなカスケード式で呼び出すことも各型の変数で結果を受けて改めて呼び出すことも出来ます
</p>
<pre class=quote10>
hiMongo#use                    =&gt; DB
   DB#in                       =&gt; Collection
      Collection#find          =&gt; Finder
         Finder#sort           =&gt; Finder
         Finder#limit          =&gt; Finder
         Finder#skip           =&gt; Finder
         Finder#forEachXXX     =&gt; Finder
         Finder#getXXXList     =&gt; ArrayList&lt;XXX&gt;
      Collection#aggregate     =&gt; Aggregator
         Aggregator#forEachXXX =&gt; Aggregator
         Aggregator#getXXXList =&gt; ArrayList&lt;XXX&gt;
      Collection#insertOne     =&gt; Collection
      Collection#insertMany    =&gt; Collection
      Collection#updateOne     =&gt; Collection
      Collection#updateMany    =&gt; Collection
      Collection#replaceOne    =&gt; Collection
      Collection#deleteOne     =&gt; Collection
      Collection#deleteMany    =&gt; Collection
</pre>
<p>
各型のインスタンスで受けて操作する場合は次のような形です。
</p>
<pre class=quote10>
hiMongo.DB         db  = hiMongo.use("db01");
hiMongo.Collection _coll= db.in("coll_01");
_coll.find("{}","{_id:0}");
_coll.sort("{_id:-1}");
_coll.limit(3);
ArrayList&lr;String&gt; _recs=coll.getJsonList(hiU.REVERT);
for(Document _rec:_recs)System.out.println(_rec);
</pre>
<p>
カスケード式では次の様になります。
</p>
<pre class=quote10>
hiMongo.DB db = hiMongo.use("db01");
db.in("coll_01")                     // DBのget()
  .find("{}","{_id:0}")               // Collectionのfind()
  .sort("{_id:-1}")                   // Finderのsort()
  .limit(3)                           // Finderのlimit()
  .getJsonList(hiU.REVERT)            // Finder(Accessor)のgetJsonList()
  .forEach(Rj-&gt;System.out.println(Rj)); // ArrayListのforEach()
// use()から続けることも可能ですが、習慣上DBにはdbという変数を割り当てます。
</pre>


<a class=A1 href="#top">top</a>、<a class=A1 href="#API">API</a>
<p class=B1 id=find>
&emsp;find(検索)の引数と結果
</p>
<p>
<a href="../../hi/db/hiMongo.Collection.html#find-java.lang.Object-java.lang.Object-"><code>find</code></a>は２つの引数を持ちます。検索条件と取得フィールドです。<br>
</p>
<p class=c>
&emsp;検索条件
</p>
<p>
検索条件には次の様な記述が出来ます。
</p>

<table class=t>
<tr>
<td>条件</td>
<td>記述例</td>
</tr>
<tr>
<td>無条件</td>
<td>find()またはfind("{}")</td>
</tr>
<tr>
<td>フィールド値の単純一致</td>
<td>find("{name:'A'}")</td>
</tr>
<tr id="compare">
<td>フィールド値の大小判断</td>
<td>find("{value:{$gt:100}}")
<pre class=quot8>
形式:
{<i>field</i>:{$eq:<i>値</i>}}        ==
{<i>field</i>:{$ne:<i>値</i>}}        !=
{<i>field</i>:{$lt:<i>値</i>}}        &lt;
{<i>field</i>:{$lte:<i>値</i>}}       &lt;=
{<i>field</i>:{$gt:<i>値</i>}}        &gt;
{<i>field</i>:{$gte:<i>値</i>}}       &gt;=
{<i>field</i>:{$in:[<i>値,..</i>]}}   含まれる
{<i>field</i>:{$nin:[<i>値,...</i>]}} 含まれない
</pre>
</td>
</tr>
<tr id="logic_ope">
<td>条件の組み合わせ</td>
<td>find("{$and:[{name:'A'},{value:{$gt:100}}]}")
<pre class=quot8>
形式:
{$and:[{条件},{条件},...]}
{$or:[{条件},{条件},...]}
{$not:{条件}}
</pre>

</td>
</tr>
<tr>
<td>部分一致、正規表現</td>
<td>
find("{name:/et/}")       nameがetを含む<br> 
find("{name:/^T.*sky$/}") nameがTで始まりskyで終わる<br>
find("{name:/(ba|ab)/}")  nameがbaまたはabを含む
</td>
</tr>
</table>


<p class=c id="get_field">
&emsp;取得フィールド
</p>
<p>
取得フィールドの指定は{}内に「フィールド名：0または１」を必要分カンマで繋いで記述します。<br>
0は非表示（取得しない)を1は表示(取得する)を表します。<br>
指定は_idフィールドとその他の利用者フィールドでは意味が少し異なります。<br>
利用者フィールドに1を指定した場合、指定しないフィールドは非表示となります。0を指定した場合指定フィールドが非表示となります。<br>
利用者フィールドの指定に0と1が混在することは許されません。
</p>
<pre class=quote10>
find()                       // 全て取得
find("{}")                   // 全て取得
find("{}","{}")              // 全て取得
find("{}","{_id:0}")         // _idフィールド以外全て取得
<span class=gray>{ "A" : 10, "B" : 20, "C" : 30, "D" : 40 }
{ "A" : 11, "B" : 21, "C" : 31, "D" : 41 }</span>
find("{}","{_id:0,A:1}")     // Aフィールドのみ取得
<span class=gray>{ "A" : 10 }
{ "A" : 11 }</span>
find({},{_id:0,A:0})         // _id,Aフィールド以外取得
<span class=gray>{ "B" : 20, "C" : 30, "D" : 40 }
{ "B" : 21, "C" : 31, "D" : 41 }</span>
find("{}","{_id:0,A:1,C:1}") // A,Cフィールドのみ取得
<span class=gray>{ "A" : 10, "C" : 30 }
{ "A" : 11, "C" : 31 }</span>
find("{}","{_id:0,A:0,C:0}") // _id,A,Cフィールド取得以外取得
<span class=gray>{ "B" : 20, "D" : 40 }
{ "B" : 21, "D" : 41 }</span>
find("{}","{_id:0,A:0,C:1}") // エラー
</pre>
<p>
取得しないと指定したフィールドでも検索条件、ソート条件に使用できます。
</p>
<p class=c>
&emsp;結果の取得
</p>
<p>
<a href="../../hi/db/hiMongo.Collection.html#find-java.lang.Object-java.lang.Object-"><code>find</code></a>の戻りは<a href="../../hi/db/hiMongo.Finder.html" title="hi.db内のインタフェース"><code>hiMongo.Finder</code></a>です。<a href="../../hi/db/hiMongo.Finder.html#sort-java.lang.Object-"><code>sort()</code></a>,<a href="../../hi/db/hiMongo.Finder.html#limit-int-"><code>limit()</code></a>など幾つかの手順を経て最終的にはgetXXXList()メソッドで結果を<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/util/ArrayList.html?is-external=true" title="java.util内のクラスまたはインタフェース"><code>ArrayList&lt;T&gt;</code></a>にして戻します。
</p>
<p>
得られるリストは次のものです。
</p>
<p>
<table class=t>
<tr>
<td>要素の型</td><td>取得メソッド</td><td>説明</td>
</tr>

<tr>
<td><a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース"><code>Document</code></a></td><td><a href="../../hi/db/hiMongo.Accessor.html#getDocumentList-long-"><code>getDocumentList</code></a></td>
<td>
mongoDBのデータノードです。<br>
基本的にはJSONに対応するObjectのツリーです。<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース"><code>Document</code></a>は<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/util/Map.html?is-external=true" title="java.util内のクラスまたはインタフェース"><code>Map&lt;String,Object&gt;</code></a>型の辞書です。Stringや数値などの基本タイプの他<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/types/ObjectId.html?is-external=true" title="org.bson.types内のクラスまたはインタフェース"><code>ObjectId</code></a>クラス,<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/util/Date.html?is-external=true" title="java.util内のクラスまたはインタフェース"><code>Date</code></a>クラスを持ちます。
</td>
</tr>

<tr>
<td>クラスインスタンス</td><td><a href="../../hi/db/hiMongo.Accessor.html#getClassList-java.lang.Class-long-"><code>getClassList</code></a></td>
<td>
利用者クラスにマップしたデータが得られます。<br>
最も間違いが起こりにくい方法です。
</td>
</tr>

<tr>
<td><a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Probe.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース"><code>hiJSON.Probe</code></a></td><td><a href="../../hi/db/hiMongo.Accessor.html#getProbeList-long-"><code>getProbeList</code></a></td>
<td>
データノードの探索機です。<br>
探索対象となるノード自体は<a href="../../hi/db/hiMongo.Accessor.html#getDocumentList-long-"><code>getDocumentList()</code></a>で得られるものと同じ<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース"><code>Document</code></a>とその構成要素（文字列やリスト、数値など）です。<br>
<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース"><code>Document</code></a>はMap&lt;String,Object&gt;であり<a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Probe.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース"><code>hiJSON.Probe</code></a>では辞書として扱われます。
</td>
</tr>


<tr>
<td>String(mson)</td><td><a href="../../hi/db/hiMongo.Accessor.html#getMsonList-long-"><code>getMsonList</code></a></td>
<td>
mongoの拡張JSON形の文字列。<br>
ObjectId("..."),ISODate("...")が用いられます。
</td>
</tr>


<tr>
<td>String(json)</td><td><a href="../../hi/db/hiMongo.Accessor.html#getJsonList-long-"><code>getJsonList</code></a></td>
<td>
標準JSON形の文字列。<br>
{"$oid":"..."},{"$date":"..."}が用いられます。
</td>
</tr>

</table>
</p>
<p>
getXxxList()にhiU.REVERSEを付けると逆並びとなります。
<a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiU.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース"><code>hiU</code></a>は汎用ライブラリ<a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/package-summary.html?is-external=true"><code>otsu.hiNote</code></a>の代表クラスです。
</p>
<p>
<a href="../../hi/db/hiMongo.Finder.html" title="hi.db内のインタフェース"><code>hiMongo.Finder</code></a>が持つforEachXXX()メソッドを用いればリストを構築することなく、各要素毎得ることが出来ます。
</p>

<p class=B2_2 id="getDocument">
&emsp;<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース"><code>Document</code></a>で取得
</p>
<p>
<a href="../../hi/db/hiMongo.Collection.html#find-java.lang.Object-java.lang.Object-"><code>find</code></a>の結果を<a href="../../hi/db/hiMongo.Accessor.html#getDocumentList-long-"><code>getDocumentList()</code></a>を用い検索結果を<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース"><code>Document</code></a>のリストとして得ることが出来ます。<br>
引数としてhiU.REVERSEを付けると逆順のリストが得られます。
</p>
<pre class=quote10>
hiMongo.DB db=hiMongo.use("db01");
ArrayList&lt;Document&gt; _dlist
=db.in("coll_01")
   .find("{}","{_id:0}")
   .getDocumentList();
</pre>
<p>
<a href="../../hi/db/hiMongo.Finder.html#forEachDocument-otsu.hiNote.hiU.ConsumerEx-"><code>forEachDocument(Documentを引数とするラムダ式)</code></a>用いるとリストを構成することなく一要素毎に処理することが出来ます。
</p>
<pre class=quote10>
hiMongo.DB db=hiMongo.use("db01");
db.in("coll_01")
  .find("{}","{_id:0}")
  .forEachDocument(Rd-&gt;System.out.println(Rd.toJson()));
</pre>

<p class=B2_2 id="getClass">
&emsp;利用者定義クラス・インスタンスとして取得
</p>
<p>
<a href="../../hi/db/hiMongo.Collection.html#find-java.lang.Object-java.lang.Object-"><code>find</code></a>の結果を<a href="../../hi/db/hiMongo.Accessor.html#getClassList-java.lang.Class-long-"><code>getClassList()</code></a>を用い検索結果を利用者定義のクラス・インスタンスのリストとして得ることが出来ます。
</p>
<pre class=quote10>
<span class=red>class MyRecord</span> {   // レコード内容
   String type;
   double value;
   Date   date;
   }
-----
double _start_date=取得開始レコードのunixエポック
ArrayList&lt;<span class=red>MyRecord</span>&gt; _recs
=db.in("coll_01")
   .find("{$and:["+
            "{type:'A'},"+
            "{date:{$gte:{$date:"+_start_date+"}}}"+
            "]}",
         "{_id:0}")
   .<span class=blue>getClassList</span>(<span class=red>MyRecord.class</span>);
<span class=gray>for(MyRecord _rec:_recs){
   System.out.println("value="+_rec.value);
   }</span>
</pre>

<div id="divClass_1">
<p><input type="button" value="フルコードを表示する" style="WIDTH:12em"
   onClick="document.getElementById('divClass_2').style.display='block';
            document.getElementById('divClass_1').style.display='none'"></p>
</div>
<div id="divClass_2" style="display:none">
<p><input type="button" value="フルコードを隠す" style="WIDTH:12em"
   onClick="document.getElementById('divClass_2').style.display='none';
            document.getElementById('divClass_1').style.display='block'"></p>
<pre class=quote8>
// このプログラムでは先ず最後のレコードのdate情報を取得し、それから
// 30秒前からのレコードをRecordクラスの並びとして取得し、統計情報を
// 計算しています。
import hi.db.hiMongo;
import otsu.hiNote.*;
import java.util.*;
public class Test {
   static class WithDate { // dateだけを得るクラス
      Date date;
      }
   static class Record {   // レコード内容
      String type;
      double value;
      Date   date;
      }
   public static void main(String[] args_){
      hiMongo.DB db=hiMongo.use("db01");
      // 最後の'A'レコードの時刻(unix-epoch)を得る
      long _last_date
      =db.in("coll_01")
         .find("{type:'A'}","{_id:0,date:1}")
         .sort("{_id:-1}").limit(1)
         .getClassList(WithDate.class)
         .get(0).date.getTime();

      // 最後のレコードの30秒前からの'A'レコード取得
      long _start_date= _last_date-30000; // 30秒前
      System.out.println("last="+_last_date+" start="+_start_date);
      ArrayList&lt;Record&gt; _recs
      =db.in("coll_01")
         .find("{$and:["+
                     "{type:'A'},"+
                     "{date:{$gte:{$date:"+_start_date+"}}}"+
                      "]}",
               "{_id:0}")
         .getClassList(Record.class);
      System.out.println("records="+hiU.str(_recs,hiU.WITH_INDENT));

      // 最大、最少、平均を求める
      double _min  = Double.MAX_VALUE;
      double _max  = Double.MIN_VALUE;
      double _total= 0;
      for(Record _rec:_recs){
         double _val=_rec.value;
         _min    = Math.min(_min,_val);
         _max    = Math.max(_max,_val);
         _total += _val;
         }
      double _avg= _total/_recs.size();
      System.out.printf("min=%.2f max=%.2f avg=%.2f\n",_min,_max,_avg);
      }
// <a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiU.html?is-external=true#str-java.lang.Object-long-" title="otsu.hiNote内のクラスまたはインタフェース"><code>hiU.str()</code></a>は構造を表示するメソッドです.
// hiU.WITH_INDENTはインデントを付加するオプションです。<a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiFieldFormat.html?is-external=true#option" title="otsu.hiNote内のクラスまたはインタフェース"><code>hiFieldFormatオプション</code></a>参照
＊＊＊＊＊＊　dbデータ
&gt; use db01
switched to db db01
&gt; db.coll_01.find({},{_id:0})
{ "type" : "A", "value" : 12.3, "date" : ISODate("2020-08-17T07:07:00Z") }
{ "type" : "A", "value" : 4.56, "date" : ISODate("2020-08-17T07:07:10Z") }
{ "type" : "B", "value" : 2001, "date" : ISODate("2020-08-17T07:07:20Z") }
{ "type" : "A", "value" : 7.89, "date" : ISODate("2020-08-17T07:07:30Z") }
{ "type" : "A", "value" : 0.12, "date" : ISODate("2020-08-17T07:07:40Z") }
＊＊＊＊＊＊　ビルド実行結果
$ ./run.sh
----- 02classAssign -----
last=1597648060000 start=1597648030000
records=[
   {
      type="A",
      value=4.56,
      date=Mon Aug 17 16:07:10 JST 2020},
   {
      type="A",
      value=7.89,
      date=Mon Aug 17 16:07:30 JST 2020},
   {
      type="A",
      value=0.12,
      date=Mon Aug 17 16:07:40 JST 2020}]
min=0.12 max=7.89 avg=4.19
OK
</pre>
<p><input type="button" value="フルコードを隠す△" style="WIDTH:12em"
   onClick="document.getElementById('divClass_2').style.display='none';
            document.getElementById('divClass_1').style.display='block';
            document.location='#divClass_1'"></p>
</div>

<p>
参考:サブ・クエリー風の手続きコードも書けます。
</p>
<div id="divSubQuery_1">
<p><input type="button" value="参考コードを表示する" style="WIDTH:12em"
   onClick="document.getElementById('divSubQuery_2').style.display='block';
            document.getElementById('divSubQuery_1').style.display='none'"></p>
</div>
<div id="divSubQuery_2" style="display:none">
<p><input type="button" value="参考コードを隠す" style="WIDTH:12em"
   onClick="document.getElementById('divSubQuery_2').style.display='none';
            document.getElementById('divSubQuery_1').style.display='block'"></p>
<pre class=quote8>
import hi.db.hiMongo;
import otsu.hiNote.*;
import java.util.*;
public class Test {
   static class WithDate { // dateだけを得るクラス
      Date date;
      }
   static class Record {   // レコード内容
      String type;
      double value;
      Date   date;
      }
   public static void main(String[] args_){
      hiMongo.DB db=hiMongo.use("db01");
      ArrayList&lt;Record&gt; _recs
      =db.in("coll_01")
         .find("{$and:["+
                     "{type:'A'},"+
                     "{date:{$gte:{$date:"+
              <span class=green>(
              db.in("coll_01")
                .find("{type:'A'}","{_id:0,date:1}")
                .sort("{_id:-1}").limit(1)
                .getClassList(WithDate.class)
                .get(0).date.getTime()-30000
              )</span>
                                          +"}}}"+
                      "]}",
               "{_id:0}")
         .getClassList(Record.class);
      System.out.println("records="+hiU.str(_recs,hiU.WITH_INDENT));

      // 最大、最少、平均を求める
      double _min  = Double.MAX_VALUE;
      double _max  = Double.MIN_VALUE;
      double _total= 0;
      for(Record _rec:_recs){
         double _val=_rec.value;
         _min    = Math.min(_min,_val);
         _max    = Math.max(_max,_val);
         _total += _val;
         }
      double _avg= _total/_recs.size();
      System.out.printf("min=%.2f max=%.2f avg=%.2f\n",_min,_max,_avg);
      }
   }
// この例では同一Collectionの２つのインスタンスをget()して用いていますが、
// 一個のインスタンスで異なるfind()を多重に行っても構いません。それぞれ
// 別のFinderとなるからです。
</pre>
<p><input type="button" value="参考コードを隠す△" style="WIDTH:12em"
   onClick="document.getElementById('divSubQuery_2').style.display='none';
            document.getElementById('divSubQuery_1').style.display='block';
            document.location='#divSubQuery_1'"></p>
</div>
<p>
要素の過不足がチェックされますので、チェックをオフにする必要がある場合はgetClassList()の前にチェックをオフにする指定を入れます。<br>
<a href="../../hi/db/hiMongo.Finder.html#without_option-long-"><code>hiMongo.Finder.without_option(long)</code></a>を用います。指定するフラグは<a class=A1 href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.html#option">hiJSONのパーズオプション</a>を参照してください
</p>
<pre class=quote10>
ArrayList&lt;MyClass&gt; _recs=
db.in("coll_01")
  .find("{}","{_id:0}")
  .without_option(hiU.CHECK_UNKNOWN_FIELD // クラスにないフィールドを無視する
                 |hiU.CHECK_UNSET_FIELD)  // セットされないフィールドをエラーとしない
  .getClassList();
</pre>
<p>
<a href="../../hi/db/hiMongo.Finder.html#forEachClass-java.lang.Class-otsu.hiNote.hiU.ConsumerEx-"><code>forEachClass(class,クラスインスタンスを引数とするラムダ式)</code></a>を用いるとリストを構成することなく一要素毎に処理することが出来ます。
</p>
<pre class=quote10>
hiMongo.DB db=hiMongo.use("db01");
db.in("coll_01")
  .find("{}","{_id:0}")
  .forEachClass(MyClass.class,Rc-&gt;System.out.println(Rc.value));
</pre>

<p class=B1_2 id=getProbe>
&emsp;汎用データ探索機<a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Probe.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース"><code>hiJSON.Probe</code></a>で取得
</p>
<p>
<a href="../../hi/db/hiMongo.Collection.html#find-java.lang.Object-java.lang.Object-"><code>find</code></a>の結果を<a href="../../hi/db/hiMongo.Accessor.html#getProbeList-long-"><code>getProbeList()</code></a>を用い検索結果を<a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Probe.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース"><code>hiJSON.Probe</code></a>のリストで受け取ることが出来ます。<br>
<a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Probe.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース"><code>hiJSON.Probe</code></a>は汎用ノードの探索機で辞書(Map&lt;String,Object&gt;).リスト(List&lt;Object&gt;),文字列,数値などで構成されるツリーを探査するメソッドを持ちます。<br>
<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース"><code>Document</code></a>は辞書/Map&lt;String,Object&gt;ですのでProbeの探索対象となります。<br>
要素へのアクセスは文字列による名前での指定となります。
</p>
<pre class=quote10>
double _start_date=取得開始レコードのunixエポック
ArrayList&lt;hiJSON.Node&gt; _recs
=db.in("coll_01")
   .find("{$and:["+
            "{type:'A'},"+
            "{date:{$gte:{$date:"+_start_date+"}}}"+
            "]}",
         "{_id:0}")
   .<span class=blue>getProbeList</span>();
<span class=gray>for(hiJSON.Probe _probe:_recs){
   System.out.println("value="+_probe.at("value").getDouble());
   }</span>
</pre>
<div id="divProbe_1">
<p><input type="button" value="フルコードを表示する" style="WIDTH:12em"
   onClick="document.getElementById('divProbe_2').style.display='block';
            document.getElementById('divProbe_1').style.display='none'"></p>
</div>
<div id="divProbe_2" style="display:none">
<p><input type="button" value="フルコードを隠す" style="WIDTH:12em"
   onClick="document.getElementById('divProbe_2').style.display='none';
            document.getElementById('divProbe_1').style.display='block'"></p>
<pre class=quote8>
import hi.db.hiMongo;
import otsu.hiNote.*;
import java.util.*;
public class Test {
   public static void main(String[] args_){
      hiMongo.DB db=hiMongo.use("db01");
      // 最後の'A'レコードの時刻(unix-epoch)を得る
      long _last_date
      =db.in("coll_01")
         .find("{type:'A'}","{_id:0,date:1}")
         .sort("{_id:-1}").limit(1)
         .getProbeList()
         .get(0).at("date").get(D-&gt;((Date)D).getTime());

      // 最後のレコードの30秒前からの'A'レコード取得
      long _start_date= _last_date-30000; // 30秒前
      System.out.println("last="+_last_date+" start="+_start_date);
      ArrayList&lt;hiJSON.Probe&gt; _recs
              =db.in("coll_01")
                 .find("{$and:["+
                           "{type:'A'},"+
                           "{date:{$gte:{$date:"+_start_date+"}}}"+
                            "]}",
                        "{_id:0}")
                 .getProbeList();

      // 最大、最少、平均を求める
      double _min  = Double.MAX_VALUE;
      double _max  = Double.MIN_VALUE;
      double _total= 0;
      for(hiJSON.Probe _probe:_recs){
         double _val= _probe.at("value").getDouble();
         _min    = Math.min(_min,_val);
         _max    = Math.max(_max,_val);
         _total += _val;
         }
      double _avg= _total/_recs.size();
      System.out.printf("min=%.2f max=%.2f avg=%.2f\n",_min,_max,_avg);
      }
   }
＊＊＊＊＊＊　dbデータ
&gt; use db01
switched to db db01
&gt; db.coll_01.find({},{_id:0})
{ "type" : "A", "value" : 12.3, "date" : ISODate("2020-08-17T07:07:00Z") }
{ "type" : "A", "value" : 4.56, "date" : ISODate("2020-08-17T07:07:10Z") }
{ "type" : "B", "value" : 2001, "date" : ISODate("2020-08-17T07:07:20Z") }
{ "type" : "A", "value" : 7.89, "date" : ISODate("2020-08-17T07:07:30Z") }
{ "type" : "A", "value" : 0.12, "date" : ISODate("2020-08-17T07:07:40Z") }
＊＊＊＊＊＊　ビルド実行結果
$ ./run.sh
----- 03probeAccess -----
last=1597648060000 start=1597648030000
min=0.12 max=7.89 avg=4.19
OK
</pre>
<p><input type="button" value="フルコードを隠す△" style="WIDTH:12em"
   onClick="document.getElementById('divProbe_2').style.display='none';
            document.getElementById('divProbe_1').style.display='block';
            document.location='#divProbe_1'"></p>
</div>
<p>
<a href="../../hi/db/hiMongo.Finder.html#forEachProbe-otsu.hiNote.hiU.ConsumerEx-"><code>forEachProbe(Probeを引数とするラムダ式)</code></a>を用いるとリストを構成することなく一要素毎に処理することが出来ます。
</p>
<pre class=quote10>
hiMongo.DB db=hiMongo.use("db01");
db.in("coll_01")
  .find("{}","{_id:0}")
  .forEachProbe(Rp-&gt;System.out.println(Rp.getDouble("value")));
</pre>

<p class=B2_2 id="getJsonMson">
&emsp;JSON文字列、拡張JSON文字列で取得
</p>
<p>
<a href="../../hi/db/hiMongo.Collection.html#find-java.lang.Object-java.lang.Object-"><code>find</code></a>の結果を<a href="../../hi/db/hiMongo.Accessor.html#getJsonList-long-"><code>getJsonList()</code></a>を用いれば純粋なJSON文字列リスト、
<a href="../../hi/db/hiMongo.Accessor.html#getMsonList-long-"><code>getMsonList()</code></a>を用いれば拡張JSON文字列のリストとして得ることが出来ます。
</p>
<pre class=prog10>
hiMongo.DB db=hiMongo.use("db01");
ArrayList&lt;String&gt; _jsons
=db.in("coll_01")
  .find("{}","{_id:0}")
  .getJsonList();
</pre>
<p>
<a href="../../hi/db/hiMongo.Finder.html#forEachJson-otsu.hiNote.hiU.ConsumerEx-"><code>forEachJson(Json文字列を引数とするラムダ式)</code></a>,<a href="../../hi/db/hiMongo.Finder.html#forEachMson-otsu.hiNote.hiU.ConsumerEx-"><code>forEachMson(Mson文字列を引数とするラムダ式)</code></a>を用いるとリストを構成することなく一要素毎に処理することが出来ます。
</p>
<pre class=quote10>
hiMongo.DB db=hiMongo.use("db01");
db.in("coll_01")
  .find("{}","{_id:0}")
  .forEachJson(Rj-&gt;System.out.println(Rj));
</pre>



<a class=A1 href="#top">top</a>、<a class=A1 href="#API">API</a>
<p class=B1 id="insert_and_others">
&emsp;insert等のレコード処理
</p>
<p>
コレクション内のレコードの操作として追加（insert)、削除(delete)、更新(update)、置き換え(replace)、コレクションごと全削除(drop)が用意されています。

<div id="divInser_1">
<p><input type="button" value="フルコードを表示する" style="WIDTH:12em"
   onClick="document.getElementById('divInser_2').style.display='block';
            document.getElementById('divInser_1').style.display='none'"></p>
</div>
<div id="divInser_2" style="display:none">
<p><input type="button" value="フルコードを隠す" style="WIDTH:12em"
   onClick="document.getElementById('divInser_2').style.display='none';
            document.getElementById('divInser_1').style.display='block'"></p>
<pre class=quote8>
import hi.db.hiMongo;
import otsu.hiNote.*;
import java.util.*;
public class Test {
   public static void main(String[] args_){
      hiMongo.DB db =hiMongo.use("db01");
      hiMongo.Collection  _coll=db.in("coll_01").drop();
      System.out.println("--- insertOne/insertMany");
      _coll.insertOne(
           " {type:'A',value:12.3,date:"+hiMongo.date()+"}");
      _coll.insertMany("["+
           " {type:'A',value:4.56,date:"+hiMongo.date()+"}"+
           ",{type:'B',value:2001,date:"+hiMongo.date()+"}"+
           ",{type:'A',value:7.89,date:"+hiMongo.date()+"}"+
           ",{type:'A',value:0.12,date:"+hiMongo.date()+"}]");
      _coll.find("{}","{_id:0}").forEach(Rd-&gt;System.out.println(Rd));

      System.out.println("--- updateOne");
      _coll.updateOne("{$and:[{type:'B'},{value:{$gt:5}}]}",
                      "{$set:{value:4.32}}");
      _coll.find("{}","{_id:0,date:0}").forEach(Rd-&gt;System.out.println(Rd));

      System.out.println("--- updateMany");
      _coll.updateMany("{$and:[{type:'A'},{value:{$lt:5}}]}",
                      "{$set:{value:3.21}}");
      _coll.find("{}","{_id:0,date:0}").forEach(Rd-&gt;System.out.println(Rd));

      System.out.println("--- replaceOne");
      _coll.replaceOne("{$and:[{type:'A'},{value:{$lt:5}}]}",
                      "{type:'B',value:6543,date:"+hiMongo.date()+"}");
      _coll.find("{}","{_id:0,date:0}").forEach(Rd-&gt;System.out.println(Rd));

      System.out.println("--- deleteOne");
      _coll.deleteOne("{type:'B'}");
      _coll.find("{}","{_id:0,date:0}").forEach(Rd-&gt;System.out.println(Rd));

      System.out.println("--- deleteMany");
      _coll.deleteMany("{$and:[{type:'A'},{value:{$lt:8}}]}");
      _coll.find("{}","{_id:0,date:0}").forEach(Rd-&gt;System.out.println(Rd));
      }
   }
＊＊＊＊＊＊　ビルド実行結果
$ ./run.sh
----- 06insert -----
--- insertOne/insertMany
Document{{type=A, value=12.3, date=Tue Aug 25 03:08:53 JST 2020}}
Document{{type=A, value=4.56, date=Tue Aug 25 03:08:53 JST 2020}}
Document{{type=B, value=2001, date=Tue Aug 25 03:08:53 JST 2020}}
Document{{type=A, value=7.89, date=Tue Aug 25 03:08:53 JST 2020}}
Document{{type=A, value=0.12, date=Tue Aug 25 03:08:53 JST 2020}}
--- updateOne
Document{{type=A, value=12.3}}
Document{{type=A, value=4.56}}
Document{{type=B, value=4.32}}
Document{{type=A, value=7.89}}
Document{{type=A, value=0.12}}
--- updateMany
Document{{type=A, value=12.3}}
Document{{type=A, value=3.21}}
Document{{type=B, value=4.32}}
Document{{type=A, value=7.89}}
Document{{type=A, value=3.21}}
--- replaceOne
Document{{type=A, value=12.3}}
Document{{type=B, value=6543}}
Document{{type=B, value=4.32}}
Document{{type=A, value=7.89}}
Document{{type=A, value=3.21}}
--- deleteOne
Document{{type=A, value=12.3}}
Document{{type=B, value=4.32}}
Document{{type=A, value=7.89}}
Document{{type=A, value=3.21}}
--- deleteMany
Document{{type=A, value=12.3}}
Document{{type=B, value=4.32}}
OK
</pre>
<p><input type="button" value="フルコードを隠す△" style="WIDTH:12em"
   onClick="document.getElementById('divInser_2').style.display='none';
            document.getElementById('divInser_1').style.display='block';
            document.location='#divInser_1'"></p>
</div>

<p>
レコードインサートには利用者クラスを使う事もできます。
</p>

</p>
<p class=B1_2 id="col_insert">
&emsp;insert
</p>
<p>
<a href="../../hi/db/hiMongo.Collection.html#insertOne-java.lang.Object...-"><code>insertOne()</code></a>の引数は１レコードの拡張JSON形式で、<a href="../../hi/db/hiMongo.Collection.html#insertMany-java.lang.Object...-"><code>insertMany()</code></a>の引数は拡張JSONのList型です。<br>
それらを記述したテキストファイル、あるいはそれらの解析されたノードツリーも許されます。<br>
条件文は付きません。
</p>
<p>
次の様な使い方になります。<a href="../../hi/db/hiMongo.DB.html#in-java.lang.String-"><code>in("コレクション")</code></a>はその時点で存在しないコレクションに対して行っても構いません。なお<a href="../../hi/db/hiMongo.html#date--"><code>hiMongo.date()</code></a>は現在時の標準JSON表現を得る関数です。
</p>
<pre class=quote10>
hiMongo.DB db =hiMongo.use("db01");
db.in("coll_01")
  .insertOne(
     " {type:'A',value:12.3,date:"+hiMongo.date()+"}");
</pre>
<p class=B1_2 id="col_drop">
&emsp;drop
</p>
<p>
<a href="../../hi/db/hiMongo.Collection.html#drop--"><code>drop()</code></a>はレコードの削除のみならずコレクションそのものの削除ですが、<a href="../../hi/db/hiMongo.Collection.html#insertOne-java.lang.Object...-"><code>insertOne()</code></a>,<a href="../../hi/db/hiMongo.Collection.html#insertMany-java.lang.Object...-"><code>insertMany()</code></a>を繋げると、元の名前のコレクションが再び作成され空の状態でのレコード追加となります。
</p>
<pre class=quote10>
hiMongo.DB db =hiMongo.use("db01");
db.in("coll_01")
  .drop()
  .insertMany("["+
     " {type:'A',value:4.56,date:"+hiMongo.date()+"}"+
     ",{type:'B',value:2001,date:"+hiMongo.date()+"}"+
     ",{type:'A',value:7.89,date:"+hiMongo.date()+"}"+
     ",{type:'A',value:0.12,date:"+hiMongo.date()+"}]");
</pre>

<p class=B1_2 id="col_delete">
&emsp;delete
</p>
<p>
<a href="../../hi/db/hiMongo.Collection.html#deleteOne-java.lang.Object-"><code>deleteOne()</code></a>では登録の古いレコードが検索され、合致した一個のみが削除されます。<br>
<a href="../../hi/db/hiMongo.Collection.html#deleteMany-java.lang.Object-"><code>deleteMany()</code></a>では合致するレコードが全て削除されます。
</p>
<pre class=quote10>
hiMongo.DB         db   =hiMongo.use("db01");
hiMongo.Collection _coll=db.in("coll_01");
// --- deleteOne
_coll.deleteOne("{type:'B'}");

// --- deleteMany
_coll.deleteMany("{$and:[{type:'A'},{value:{$lt:8}}]}");
</pre>

<p class=B1_2 id="col_update">
&emsp;update
</p>
<p>
<a href="../../hi/db/hiMongo.Collection.html#updateOne-java.lang.Object-java.lang.Object-"><code>updateOne()</code></a>,<a href="../../hi/db/hiMongo.Collection.html#updateMany-java.lang.Object-java.lang.Object-"><code>updateMany()</code></a>は{$set:{フィールド名:値}}でフィールドの値の変更を指定します。<br>
複数フィールドの置き換えはフィールド名の値のセットをカンマで繋ぎます{$set:{フィールド1:値1,フィールド2:値2,...}<br>
存在しないフィールド名を指定するとフィールドの追加となります。<br>
単純な値の置き換えを行う$setの他に値の増減を行う$incなども用意されています。
(<a class=A1 href=
"https://docs.mongodb.com/manual/reference/operator/update/"
>更新の演算子</a>参照)
</p>
<p>
$setによる単純置き換え例(この例では3に置き換えている）
</p>
<pre class=quote10>
---- before $set
{'type':'C', 'name':'X', 'value':5}
{'type':'C', 'name':'Y', 'value':10}
{'type':'C', 'name':'X', 'value':13}
---- program
  .updateMany("{$and:[{type:'C'},{name:'X'}]}",
              "{$set:{value:3}}")
---- after $set
{'type':'C', 'name':'X', 'value':3}
{'type':'C', 'name':'Y', 'value':10}
{'type':'C', 'name':'X', 'value':3}
</pre>
<p>
$incによる増減例(この例では+3している)
</p>
<pre class=quote10>
---- before $inc
{'type':'C', 'name':'X', 'value':5}
{'type':'C', 'name':'Y', 'value':10}
{'type':'C', 'name':'X', 'value':13}
---- program
  .updateMany("{$and:[{type:'C'},{name:'X'}]}",
              "{$inc:{value:3}}")
---- after $inc
{'type':'C', 'name':'X', 'value':8}
{'type':'C', 'name':'Y', 'value':10}
{'type':'C', 'name':'X', 'value':16}
</pre>
<p>
条件に合致するレコードが無い場合は無処理です。
</p>
<p>
指定フィールドが存在ない場合、フィールドが追加されてしまうことに注意が必要です。<br>
指定フィールドが存在する場合のみupdateするには$existを用います。
</p>
<pre class=quote10>
   final String <span class=green>_field_name</span>="value";
   hiMongo.DB db=hiMongo.use("db01");
   db.in("coll_01")
     .updateMany("{$and:[{type:'C'},{name:'X'},{"+<span class=green>_field_name</span>+":{<span class=purple>$exists:true</span> }}]}",
                 "{$set:{"+<span class=green>_field_name</span>+":3}}");
</pre>
<p class=B1_2 id="col_replace">
&emsp;replace
</p>
<p>
<a href="../../hi/db/hiMongo.Collection.html#replaceOne-java.lang.Object-java.lang.Object-"><code>replaceOne()</code></a>はレコード全体の置き換えになります。<br>
条件とレコード全体が引数となります。replaceMany()は有りません。
</p>
<pre class=quote10>
// --- replaceOne
_coll.replaceOne("{$and:[{type:'A'},{value:{$lt:5}}]}",
                 "{type:'B',value:6543,date:"+hiMongo.date()+"}");

</pre>



<p class=B1_2 id="class_insert">
&emsp;利用者定義クラス・インスタンスをinsertする
</p>
<p>
レコード情報を持つ利用者のクラス・インスタンスを<a href="../../hi/db/hiMongo.Collection.html#insertOne-java.lang.Object...-"><code>insertOne()</code></a>を用いてinsertすることが出来ます。
</p>
<pre class=quote10>
<span class=red>class MyRecord</span> {  // レコード内容
   String   type;
   double   value;
   Date     date;
   }
-----
hiMongo.DB db =  hiMongo.use("db01");
<span class=red>MyReord    _rec= new MyRecord();</span>
_rec.type = "D";
_rec.value= 12.3;
_rec.date = new Date();
db.in("coll_01")
  .insertOne(<span class=red>_rec</span>);
</pre>
<p>
Listにすれば<a href="../../hi/db/hiMongo.Collection.html#insertMany-java.lang.Object...-"><code>insertMeny()</code></a>も可能です。
</p>

<div id="divClassInsrt_1">
<p><input type="button" value="フルコードを表示する" style="WIDTH:12em"
   onClick="document.getElementById('divClassInsrt_2').style.display='block';
            document.getElementById('divClassInsrt_1').style.display='none'"></p>
</div>
<div id="divClassInsrt_2" style="display:none">
<p><input type="button" value="フルコードを表示する" style="WIDTH:12em"
   onClick="document.getElementById('divClassInsrt_2').style.display='none';
            document.getElementById('divClassInsrt_1').style.display='block'"></p>
<pre class=quote8>
import hi.db.hiMongo;
import otsu.hiNote.*;
import java.util.*;
public class Test {
   static class MyRecord {   // レコード内容
      String type;
      double value;
      Date   date;
      }
   public static void main(String[] args_){
      hiMongo.DB db=hiMongo.use("db01");
      hiMongo.Collection coll
      =db.in("coll_01").drop();
      //
      ArrayList&lt;MyRecord&gt; _recs= new ArrayList&lt;&gt;();
      for(int _n=0;_n&lt;4;++_n){
         MyRecord _rec= new MyRecord();
         _rec.type = "C";
         _rec.value= _n*10;
         _rec.date = new Date();
         _recs.add(_rec);
         }
      coll.insertMany(_recs);
      //
      MyRecord _rec = new MyRecord();
      _rec.type = "D";
      _rec.value= 12.3;
      _rec.date = new Date();
      coll.insertOne(_rec);
      //
      coll.find()
          .forEachMson(Rm-&gt;System.out.println(Rm));
      }
   }
＠＠＠＠　実行結果
$ ./run.sh
----- 10insertClass -----
{'_id':ObjectId('5f6b2000cbaae93df916f501'), 'type':'C', 'value':0, 'date':ISODate('2020-09-23T10:14:24.535Z')}
{'_id':ObjectId('5f6b2000cbaae93df916f502'), 'type':'C', 'value':10, 'date':ISODate('2020-09-23T10:14:24.535Z')}
{'_id':ObjectId('5f6b2000cbaae93df916f503'), 'type':'C', 'value':20, 'date':ISODate('2020-09-23T10:14:24.535Z')}
{'_id':ObjectId('5f6b2000cbaae93df916f504'), 'type':'C', 'value':30, 'date':ISODate('2020-09-23T10:14:24.535Z')}
{'_id':ObjectId('5f6b2000cbaae93df916f505'), 'type':'D', 'value':12.3, 'date':ISODate('2020-09-23T10:14:24.641Z')}
OK
</pre>
<p><input type="button" value="フルコードを表示する△" style="WIDTH:12em"
   onClick="document.getElementById('divClassInsrt_2').style.display='none';
            document.getElementById('divClassInsrt_1').style.display='block';
            document.location='#divClassInsrt_1'"></p>
</div>
<p>
利用者クラスはinsert以外でも拡張JSON文字列の代わりに与えることができます。
</p>


<a class=A1 href="#top">top</a>、<a class=A1 href="#API">API</a>
<p class=B1 id="cap_index">
&emsp;cap指定（最大容量)、index設定
</p>

<p class=B1_2 id="cap">
&emsp;キャップ（最大容量)指定
</p>
<p>
<a href="../../hi/db/hiMongo.DB.html" title="hi.db内のインタフェース"><code>hiMongo.DB</code></a>の<a href="../../hi/db/hiMongo.DB.html#createCappedCollection-java.lang.String-java.lang.String-"><code>createCappedCollection()</code></a>メソッドで、容量制限付きのコレクションを作成できます。<br>
既にあるコレクションの容量を変更することは出来ません。<br>
insertOne(),insertMany()を発行した場合、制限容量に達すると、古いレコードが削除されます。
</p>
<p>
createCappedCollection()にはコレクション名と、容量情報を指定します。<br>
容量情報はJSON形式の文字列で次の形となります。
</p>
<pre class=prog10>
{
   size   :<i>バイト数</i>,
   records:<i>レコード数</i>,
   force  :<i>trueまたはfalse</i>
   }
EX {size:1000000000,records:5000,force:true}
</pre>
<p>
forceがtrueだと必ず要素無しでcap指定のされたのコレクションを作成します。<br>
forceがfalseの場合すでにコレクションがあれば無処理となります。
</p>
<div id="divCap_1">
<p><input type="button" value="例を表示する" style="WIDTH:12em"
   onClick="document.getElementById('divCap_2').style.display='block';
            document.getElementById('divCap_1').style.display='none'"></p>
</div>
<div id="divCap_2" style="display:none">
<p><input type="button" value="例を隠す" style="WIDTH:10em"
   onClick="document.getElementById('divCap_2').style.display='none';
            document.getElementById('divCap_1').style.display='block'"></p>
<pre class=quote8>
import hi.db.hiMongo;
public class Test {
   public static void main(String[] args_){
      hiMongo.DB db=hiMongo.use("db01");
      hiMongo.Collection col
      =db.createCappedCollection(
           "coll_cap",      // コレクション名
           "{size:10000,"+  // 最大容量（バイト)
           " records:5," +  // 最大レコード数
           " force:true}"   // 強制クリア
           );
      for(int _n=0;_n&lt;20;++_n){
         col.insertOne("{type:'A',value:"+(_n+1)+"}");
         }
      col.find("{}","{_id:0}")
         .forEachMson(Rm-&gt;System.out.println(Rm));
      }
   }
＊＊＊＊＊＊　ビルド実行結果
$ ./run.sh
----- 08cap -----
{'type':'A', 'value':16}
{'type':'A', 'value':17}
{'type':'A', 'value':18}
{'type':'A', 'value':19}
{'type':'A', 'value':20}
OK
</pre>
<p><input type="button" value="例を隠す△" style="WIDTH:10em"
   onClick="document.getElementById('divCap_2').style.display='none';
            document.getElementById('divCap_1').style.display='block';
            document.location='#divCap_1'"></p>
</div>

<p class=B1_2 id="index">
&emsp;インデックス指定,ユニーク性保証,生存時間制限
</p>
<p>
<a href="../../hi/db/hiMongo.Collection.html" title="hi.db内のインタフェース"><code>hiMongo.Collection</code></a>の<a href="../../hi/db/hiMongo.Collection.html#createIndex-java.lang.Object-java.lang.Object-"><code>createIndex()</code></a>を用いてインデックスを作成することにより検索の速度を上げることができます。
</p>
<p>
インデックスには値のユニーク性の保証(unique)、レコード生存時間の限定(expireAfter)などのオプションを付加することが出来ます。
</p>
<p>
次の例ではindexを作成する前と、'商品id'フィールドでindexを作成した後のインデックスのリストを出しています。
</p>
<pre class=quote10>
hiMongo.DB db=hiMongo.use("sampleDB");
<span class=gray>System.out.println("--- befor creteIndex");</span>
db.in("商品").getIndexList().forEach(Do-&gt;System.out.println(Do));
db.in("商品").createIndex("{商品id:1}","{unique:true}");
db.in("商品").createIndex("{商品id:1}","{unique:true,expireAfterDays:730}");
<span class=gray>System.out.println("--- after creteIndex");</span>
db.in("商品").getIndexList().forEach(Do-&gt;System.out.println(Do));
＠＠＠出力
--- befor creteIndex
Document{{v=2, key=Document{{_id=1}}, name=_id_, ns=sampleDB.商品}}
--- after creteIndex
Document{{v=2, key=Document{{_id=1}}, name=_id_, ns=sampleDB.商品}}
Document{{v=2, unique=true, key=Document{{商品id=1}}, name=商品id_1
          , ns=sampleDB.商品, expireAfterSeconds=63072000}}
</pre>
<p>
フルコードは<a class=A1 href="#lookup">「aggregate(集計）lookupによるフィールド結合」</a>にあります。
</p>

<a class=A1 href="#top">top</a>、<a class=A1 href="#API">API</a>
<p class=B1 id="AG">
&emsp;aggregate(集計）
</p>
<p>
<a href="../../hi/db/hiMongo.Collection.html#aggregate-java.lang.Object-"><code>aggregate()</code></a>を用いれば集計を得ることができます。<br>
結果の取得は<a href="../../hi/db/hiMongo.Collection.html#find-java.lang.Object-java.lang.Object-"><code>find()</code></a>と同様で次のものが用意されています。
</p>
<table class=t0>
<tr>
<td>Documentで受け取る</td>
<td><a href="../../hi/db/hiMongo.Accessor.html#getDocumentList--"><code>getDocumentList()</code></a> リストで受ける<br>
    <a href="../../hi/db/hiMongo.Aggregator.html#forEachDocument-otsu.hiNote.hiU.ConsumerEx-"><code>forEachDocument(Documentを引数とするラムダ式)</code></a></td>
</tr>
<tr>
<td>利用者クラスインタンスで受け取る</td>
<td><a href="../../hi/db/hiMongo.Accessor.html#getClassList-java.lang.Class-"><code>getClassList(Class)</code></a> リストで受ける<br>
    <a href="../../hi/db/hiMongo.Aggregator.html#forEachClass-java.lang.Class-otsu.hiNote.hiU.ConsumerEx-"><code>forEachClass(Class,利用者クラスインスタンスを引数とするラムダ式)</code></a></td>
</tr>
<tr>
<td>ノード探査機で受け取る</td>
<td><a href="../../hi/db/hiMongo.Accessor.html#getProbeList--"><code>getProbeList()</code></a> リストで受ける<br>
    <a href="../../hi/db/hiMongo.Aggregator.html#forEachProbe-otsu.hiNote.hiU.ConsumerEx-"><code>forEachProbe(Probeを引数とするラムダ式)</code></a></td>
</tr>
<tr>
<td>JSON文字列で受け取る</td>
<td><a href="../../hi/db/hiMongo.Accessor.html#getJsonList--"><code>getJsonList()</code></a> リストで受ける<br>
    <a href="../../hi/db/hiMongo.Aggregator.html#forEachJson-otsu.hiNote.hiU.ConsumerEx-"><code>forEachJson(Json文字列を引数とするラムダ式)</code></a></td>
</tr>
<tr>
<td>拡張JSON文字列MSONで受け取る</td>
<td><a href="../../hi/db/hiMongo.Accessor.html#getMsonList--"><code>getMsonList()</code></a> リストで受ける<br>
    <a href="../../hi/db/hiMongo.Aggregator.html#forEachMson-otsu.hiNote.hiU.ConsumerEx-"><code>forEachJson(Mson文字列を引数とするラムダ式)</code></a></td>
</tr>
</table>


<p class=B1_2 id="aggre">
&emsp;単純集計($match,$group)
</p>
<p>
$mactchと$groupで単純集計を得ることが出来ます。
</p>
<pre class=quote10>
<span class=red>class Arec</span> {
   String _id;
   double min;
   double max;
   double avg;
   }
----
double _start_date=取得開始レコードのunixエポック
<span class=red>Arec</span> _r
=db.in("coll_01")
   .aggregate("["+
      "{ $match:{$and:["+
         "{type:'A'},"+
         "{date:{$gte:{$date:"+_start_date+"}}}"+
         "]}},"+
      "{ $group:{"+
         "_id:'$type',"+
         "min:{$min:'$value'},"+
         "max:{$max:'$value'},"+
          "avg:{$avg:'$value'}}}"+
      "]")
   .getClassList(<span class=red>Arec.class</span>).get(0);
System.out.printf("min=%.2f max=%.2f avg=%.2f"
                  ,_r.min,_r.max,_r.avg));
</pre>
<p>
これは次のmongo-shell記述に相当します。
</p>
<pre class=quote10>
var _isodate=new Date(取得開始レコードのunixエポック)
var _r=
db.coll_01.
   aggregate([
    { $match:{$and:[
            {type:'A'},
            {date:{$gte:_isodate}}
            ]}},
    { $group:{_id:"$type",
          min:{$min:"$value"},
          max:{$max:"$value"},
          avg:{$avg:"$value"}}}
     ]).
   toArray()[0];
print("min="+_r.min+" max="+_r.max+" avg="+_r.avg.toFixed(2));
</pre>

<div id="divAggre_1">
<p><input type="button" value="フルコードを表示する" style="WIDTH:12em"
   onClick="document.getElementById('divAggre_2').style.display='block';
            document.getElementById('divAggre_1').style.display='none'"></p>
</div>
<div id="divAggre_2" style="display:none">
<p><input type="button" value="フルコードを隠す" style="WIDTH:12em"
   onClick="document.getElementById('divAggre_2').style.display='none';
            document.getElementById('divAggre_1').style.display='block'"></p>
<pre class=quote8>
// このプログラムでは先ず最後のレコードのdate情報を取得し、それから
// 30秒前からのレコードの統計情報をaggregateで取得しています。
import hi.db.hiMongo;
import otsu.hiNote.*;
import java.util.*;
import java.io.*;
public class Test {
   static class Arec {
      String _id;
      double min;
      double max;
      double avg;
      }
   static class WithDate {
      Date date;
      }
   public static void main(String[] args_){
      hiMongo.DB db=hiMongo.use("db01");
      long _start_date
      =db.in("coll_01")
         .find("{type:'A'}","{_id:0,date:1}")
         .sort("{_id:-1}").limit(1).getClassList(WithDate.class).get(0)
         .date.getTime()-30000;
      Arec _r
      = db.in("coll_01")
          .aggregate("["+
              "{ $match:{$and:["+
                  "{type:'A'},"+
                  "{date:{$gte:{$date:"+_start_date+"}}}"+
                  "]}},"+
              "{ $group:{"+
                   "_id:'$type',"+
                   "min:{$min:'$value'},"+
                   "max:{$max:'$value'},"+
                   "avg:{$avg:'$value'}}}"+
              "]")
          .getClassList(Arec.class).get(0);
      System.out.println("start="+_start_date);
      System.out.println(String.format("min=%.2f max=%.2f avg=%.2f"
                                       ,_r.min,_r.max,_r.avg));
      }
   }
＊＊＊＊＊＊　dbデータ
&gt; use db01
switched to db db01
&gt; db.coll_01.find({},{_id:0})
{ "type" : "A", "value" : 12.3, "date" : ISODate("2020-08-17T07:07:00Z") }
{ "type" : "A", "value" : 4.56, "date" : ISODate("2020-08-17T07:07:10Z") }
{ "type" : "B", "value" : 2001, "date" : ISODate("2020-08-17T07:07:20Z") }
{ "type" : "A", "value" : 7.89, "date" : ISODate("2020-08-17T07:07:30Z") }
{ "type" : "A", "value" : 0.12, "date" : ISODate("2020-08-17T07:07:40Z") }
＊＊＊＊＊＊　ビルド実行結果
$ ./run.sh
----- 04aggregate -----
start=1597648030000
min=0.12 max=7.89 avg=4.19
OK
</pre>
<p><input type="button" value="フルコードを隠す△" style="WIDTH:12em"
   onClick="document.getElementById('divAggre_2').style.display='none';
            document.getElementById('divAggre_1').style.display='block';
            document.location='#divAggre_1'"></p>
</div>

<p class=B1_2 id="lookup">
&emsp;$lookupによるフィールド結合
</p>
<p>
$lookupを用いれば異なるコレクションのレコード・フィールドを結合することができます。<br>
結合されたデータは利用者定義の型のリストで受け取ることができます。
</p>
<pre class=quote10>
class A_Rec {
   String       店舗名;
   int          数量;
   from商品_Rec from商品;
   static class from商品_Rec{
      String 商品名;
      int    販売単価;
      }
   }
---
ArrayList&lt;A_Rec&gt; _recs
=db.in("店舗商品")
   .aggregate("["+
      "{$match:{$or:["+
           "{'店舗名':'東京'},"+
           "{'店舗名':'福岡'}"+
           "]}},"+
      "{$lookup:{"+
          "from:'商品',"+
          "localField:'商品id',"+
          "foreignField:'商品id',"+
          "as:'from商品'"+
          "}},"+
      "{$project:{"+
          "'_id':0,"+
          "'店舗名':1,"+
          "'from商品.商品名':1,"+
          "'from商品.販売単価':1,"+
          "'数量':1}},"+
       "{$unwind:'$from商品'}"+
      "]")
    .getClassList(A_Rec.class);
<span class=gray>for(A_rec _rec:_recs){
   System.out.println(_rec.店舗名+" "+_rec.from商品.商品名
                      +" 数量:"+_rec.数量);
   }</span>
</pre>
<p>
mongo-shellの次の記述に相当します。
</p>
<pre class=quote10>
use sampleDB
db.店舗商品.
    aggregate([
       {$match:{$or:[
          {'店舗名':'東京'},
          {'店舗名':'福岡'}
          ]}},
      {$lookup:{
         from:'商品',
         localField:'商品id',
         foreignField:'商品id',
         as:'from商品'
         }},
      {$project:{
         '_id':0,
         '店舗名':1,
         'from商品.商品名':1,
         'from商品.販売単価':1,
         '数量':1}},
     {$unwind:'$from商品'}
    ]);
</pre>

<div id="div_1">
<p><input type="button" value="フルコードを表示する" style="WIDTH:12em"
   onClick="document.getElementById('div_2').style.display='block';
            document.getElementById('div_1').style.display='none'"></p>
</div>
<div id="div_2" style="display:none">
<p><input type="button" value="フルコードを隠す" style="WIDTH:12em"
   onClick="document.getElementById('div_2').style.display='none';
            document.getElementById('div_1').style.display='block'"></p>
<pre class=quote8>
// （このサンプルはcreateIndexのサンプルを兼ねています）
// 東京あるいは福岡の店舗にある商品名と個数を得ています。
// 商品名は店舗商品コレクションの"商品id"で商品コレクションを連結し
// 商品名を得ています。
import hi.db.hiMongo;
import otsu.hiNote.*;
import java.util.*;
public class Test {
   static class A_Rec {
      String       店舗名;
      int          数量;
      from商品_Rec from商品;
      static class from商品_Rec{
         String 商品名;
         int    販売単価;
         }
      }
   public static void main(String[] args_){
      hiMongo.DB db=hiMongo.use("sampleDB");
      db.in("商品").getIndexList().forEach(Do-&gt;System.out.println(Do));
      db.in("商品").createIndex("{商品id:1}","{unique:true,expireAfterDays:730}");
      db.in("商品").getIndexList().forEach(Do-&gt;System.out.println(Do));
      ArrayList&lt;A_Rec&gt; _recs=
      db.in("店舗商品").aggregate("["+
            "{$match:{$or:["+
                 "{'店舗名':'東京'},"+
                 "{'店舗名':'福岡'}"+
                 "]}},"+
            "{$lookup:{"+
                "from:'商品',"+
                "localField:'商品id',"+
                "foreignField:'商品id',"+
                "as:'from商品'"+
                "}},"+
            "{$project:{"+
                "'_id':0,"+
                "'店舗名':1,"+
                "'from商品.商品名':1,"+
                "'from商品.販売単価':1,"+
                "'数量':1}},"+
             "{$unwind:'$from商品'}"+
            "]")
         .getClassList(A_Rec.class);
      for(A_Rec _rec:_recs){
         System.out.println(_rec.店舗名+" "+_rec.from商品.商品名+" 数量:"+_rec.数量);
         }
      }
   }
＊＊＊＊＊＊　dbデータ
&gt; use sampleDB
switched to db sampleDB
&gt; db.商品.find({},{_id:0,登録日:0})
{ "商品id" : "0001", "商品名" : "Tシャツ", "商品分類" : "衣服", "販売単価" : 1000, "仕入単価" : 500 }
{ "商品id" : "0002", "商品名" : "穴あけパンチ", "商品分類" : "事務用品", "販売単価" : 500, "仕入単価" : 320 }
{ "商品id" : "0003", "商品名" : "カッターシャツ", "商品分類" : "衣服", "販売単価" : 4000, "仕入単価" : 2800 }
{ "商品id" : "0004", "商品名" : "包丁", "商品分類" : "キッチン用品", "販売単価" : 3000, "仕入単価" : 2000 }
{ "商品id" : "0005", "商品名" : "フォーク", "商品分類" : "キッチン用品", "販売単価" : 500, "仕入単価" : 300 }
{ "商品id" : "0006", "商品名" : "ステイプラー", "商品分類" : "事務用品", "販売単価" : 880, "仕入単価" : 500 }
{ "商品id" : "0007", "商品名" : "ボールペン", "商品分類" : "事務用品", "販売単価" : 100, "仕入単価" : 20 }
&gt; db.店舗商品.find({},{_id:0,更新日:0})
{ "店舗id" : "000A", "店舗名" : "東京", "商品id" : "0001", "数量" : 30 }
{ "店舗id" : "000A", "店舗名" : "東京", "商品id" : "0002", "数量" : 50 }
{ "店舗id" : "000A", "店舗名" : "東京", "商品id" : "0003", "数量" : 15 }
{ "店舗id" : "000B", "店舗名" : "名古屋", "商品id" : "0002", "数量" : 30 }
{ "店舗id" : "000B", "店舗名" : "名古屋", "商品id" : "0003", "数量" : 120 }
{ "店舗id" : "000B", "店舗名" : "名古屋", "商品id" : "0004", "数量" : 20 }
{ "店舗id" : "000B", "店舗名" : "名古屋", "商品id" : "0006", "数量" : 10 }
{ "店舗id" : "000B", "店舗名" : "名古屋", "商品id" : "0007", "数量" : 40 }
{ "店舗id" : "000C", "店舗名" : "大阪", "商品id" : "0003", "数量" : 20 }
{ "店舗id" : "000C", "店舗名" : "大阪", "商品id" : "0004", "数量" : 50 }
{ "店舗id" : "000C", "店舗名" : "大阪", "商品id" : "0006", "数量" : 90 }
{ "店舗id" : "000C", "店舗名" : "大阪", "商品id" : "0007", "数量" : 70 }
{ "店舗id" : "000D", "店舗名" : "福岡", "商品id" : "0001", "数量" : 100 }
＊＊＊＊＊＊　ビルド実行結果
$ ./run.sh
----- 05lookup -----
Document{{v=2, key=Document{{_id=1}}, name=_id_, ns=sampleDB.商品}}
Document{{v=2, key=Document{{_id=1}}, name=_id_, ns=sampleDB.商品}}
Document{{v=2, unique=true, key=Document{{商品id=1}}, name=商品id_1, ns=sampleDB.商品, expireAfterSeconds=63072000}}
東京 Tシャツ 数量:30
東京 穴あけパンチ 数量:50
東京 カッターシャツ 数量:15
福岡 Tシャツ 数量:100
OK
</pre>
<p><input type="button" value="フルコードを隠す△" style="WIDTH:12em"
   onClick="document.getElementById('div_2').style.display='none';
            document.getElementById('div_1').style.display='block';
            document.location='#div_1'"></p>
</div>



<a class=A1 href="#top">top</a>、<a class=A1 href="#API">API</a>
<p class=B1 id="mson">
&emsp;mongoDB拡張JSON(mson)記述
</p>
<p>
hiMongoはmongoDBの拡張JSON記述のパーザ、表記生成器の機能も持ちます。
</p>
<p>
パーズ結果は汎用オブジェクト（nodeツリー）または利用者クラスになります。
</p>
<p>
汎用オブジェクトレベルではmongoDBの<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース"><code>Document</code></a>と内部形式のほぼ互換性を保っています。
</p>

<p class=B1_2 id="quote">
&emsp;引用符
</p>
<p>
英文字あるいは$で始まり英数字が続くフィールド名は引用符の省略が可能です。
</p>
<p>
引用符はダブルクオート、シングルクオート何れも可能です。
</p>
<pre class=quote10>
db.in("XX").find("{\"name\":\"A\"}")// 標準
db.in("XX").find("{name:\"A\"}")// 通常フィールド名引用符省略可
db.in("XX").find("{name:'A'}")// シングルクオート可
</pre>
<p>
出力はmsonではシングルクオート、jsonはダブルクオートとしています。
</p>

<p class=B1_2 id="date">
&emsp;ObjectId,Dateと数値
</p>
<p>
mongo拡張JSON(mson:bsonパーザ)で気を付ける必要があるのが、<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/types/ObjectId.html?is-external=true" title="org.bson.types内のクラスまたはインタフェース"><code>ObjectId</code></a>と<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/util/Date.html?is-external=true" title="java.util内のクラスまたはインタフェース"><code>Date</code></a>および数値です。
</p>
<p>
これらは次の表現形を持ちます。
</p>

<p>
<table class=t>
<tr>
<td>型</td>
<td>bson(内部値)</td>
<td>mson表現</td>
<td>json表現</td>
<td>stringify表現</td>
</tr>

<tr>
<td><a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/types/ObjectId.html?is-external=true" title="org.bson.types内のクラスまたはインタフェース"><code>ObjectId</code></a></td>
<td><a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/types/ObjectId.html?is-external=true" title="org.bson.types内のクラスまたはインタフェース"><code>ObjectId</code></a></td>
<td>ObjectId("...")</td>
<td>{$oid:"..."}</td>
<td>{$oid:"..."}</td>
</tr>

<tr>
<td><a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/util/Date.html?is-external=true" title="java.util内のクラスまたはインタフェース"><code>Date</code></a></td>
<td><a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/util/Date.html?is-external=true" title="java.util内のクラスまたはインタフェース"><code>Date</code></a></td>
<td>ISODate("...")<br>
shell入力:new Date(unixEpoch)</td>
<td>{$date:unixEpoch}
<td>"..."<br>入力不可</td>
</tr>


<tr>
<td>int</td>
<td>Integer</td>
<td>NumberInt("...")</td>
<td>{$numberInt:数値}</td>
<td>数値</td>
</tr>


<tr>
<td>long</td>
<td>Long</td>
<td>NumberLong("...")</td>
<td>{$numberLong:数値}</td>
<td>数値</td>
</tr>

<tr>
<td>double</td>
<td>Double</td>
<td>数値</td>
<td>数値</td>
<td>数値</td>
</tr>


<tr>
<td><a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/math/BigDecimal.html?is-external=true" title="java.math内のクラスまたはインタフェース"><code>BigDecimal</code></a></td>
<td><a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/types/Decimal128.html?is-external=true" title="org.bson.types内のクラスまたはインタフェース"><code>Decimal128</code></a></td>
<td>NumberDecimal("...")<br>
数値入力不可</td>
<td>{$numberDecimal:"..."}<br>
数値入力不可</td>
<td>数値<br>
入力不可
</td>
</tr>

</table>
</p>
<p>
mongo-shellでは{...}系の入力はできません。指定名("$date"など)要素を持つ構造になってしまいます。
<br>
<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース"><code>Document</code></a>パーザは19桁を超える数値を扱えません。NumberDecimal(..)または{$numberDecimal:..}を使う必要があります。<br>
</p>
<p>
hiMongoでは次の扱いとなります。
</p>

<table class=t>
<tr>
<td>型</td>
<td>Object(内部値)</td>
<td>mson表現</td>
<td>json表現</td>
</tr>

<tr>
<td><a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/types/ObjectId.html?is-external=true" title="org.bson.types内のクラスまたはインタフェース"><code>ObjectId</code></a></td>
<td><a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/types/ObjectId.html?is-external=true" title="org.bson.types内のクラスまたはインタフェース"><code>ObjectId</code></a></td>
<td>ObjectId("...")</td>
<td>{$oid:"..."}</td>
</tr>

<tr>
<td><a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/util/Date.html?is-external=true" title="java.util内のクラスまたはインタフェース"><code>Date</code></a></td>
<td><a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/util/Date.html?is-external=true" title="java.util内のクラスまたはインタフェース"><code>Date</code></a></td>
<td>ISODate("...")
</td>
<td>{$date:unixEpoch}</td>

</tr>

<tr>
<td>int</td>
<td>Long</td>
<td>数値<br>
NumberInt("...")可</td>
<td>数値<br>{$numberInt:数値}入力可</td>
</tr>

<tr>
<td>long</td>
<td>Long</td>
<td>数値<br>
NumberLong("...")可</td>
<td>数値<br>{$numberLong:数値}入力可</td>
</tr>

<tr>
<td>double</td>
<td>Double</td>
<td>数値</td>
<td>数値</td>
</tr>


<tr>
<td><a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/math/BigDecimal.html?is-external=true" title="java.math内のクラスまたはインタフェース"><code>BigDecimal</code></a></td>
<td><a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/math/BigDecimal.html?is-external=true" title="java.math内のクラスまたはインタフェース"><code>BigDecimal</code></a></td>
<td>NumberDecimal("...")<br>
数値入力可
</td>
<td>数値</td>
</td>
</tr>

</table>

</p>
<p>
hiMongoのパーザには桁数制限は有りません。hiMongoのパーズでは17桁までの整数はLong、仮数15桁まで指数15以下浮動小数はDouble、それ以外は<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/math/BigDecimal.html?is-external=true" title="java.math内のクラスまたはインタフェース"><code>BigDecimal</code></a>となります。<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/math/BigDecimal.html?is-external=true" title="java.math内のクラスまたはインタフェース"><code>BigDecimal</code></a>はbsonになる時点で<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/types/Decimal128.html?is-external=true" title="org.bson.types内のクラスまたはインタフェース"><code>Decimal128</code></a>となります。<br>
<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース"><code>Document</code></a>内部データは<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース"><code>Document</code></a>特有のクラスがありhiMongo内部データのJava標準のクラスとは異なりますが互いに変換可能です。
</p>
<p>
利用者クラスにマッピングする場合、数値はどの形でも利用者クラスの要素型になります。ただし、桁あふれは無視されます。
</p>


<div id="div_dateQuote1">
<p><input type="button" value="例を表示する" style="WIDTH:12em"
   onClick="document.getElementById('div_dateQuote2').style.display='block';
            document.getElementById('div_dateQuote1').style.display='none'"></p>
</div>
<div id="div_dateQuote2" style="display:none">
<p><input type="button" value="例を隠す" style="WIDTH:12em"
   onClick="document.getElementById('div_dateQuote2').style.display='none';
            document.getElementById('div_dateQuote1').style.display='block'"></p>
<pre class=quote8>
// ISODate(...),{$date:...}いずれもDate型になります。
// 要素名の引用符は省略可能です。（付けることも可）
// 値の引用符はシングルクオートでも構いません。（ダブルクオートも可）
import hi.db.hiMongo;
import otsu.hiNote.*;
import java.util.*;
import org.bson.Document;
public class Test {
   public static void main(String[] args_){
      String _filter
      ="{$and:["+
                "{type :'A'},"+
                "{date :{$gte:ISODate('2020-08-17T07:07:00.000Z')}},"+
                "{date2:{$gte:{$date:1597648021000}}}"+
              "]}";
      System.out.println("-- org.bson.Document");
      Document _doc=Document.parse(_filter);
      System.out.println("doc        ="+_doc);
      System.out.println("doc.toJson ="+_doc.toJson());
      System.out.println("-- hi.db.hiMongo");
      Object _node=hiMongo.parseText(_filter).asNode();
      System.out.println("node/mson  ="+hiMongo.mson(_node));
      System.out.println("node/json  ="+hiMongo.json(_node));
      System.out.println("---------");
      System.out.println("doc/Object ="+hiU.str(_doc,hiU.WITH_TYPE|hiU.WITH_INDENT));
      System.out.println("node/Object="+hiU.str(_node,hiU.WITH_TYPE|hiU.WITH_INDENT));
      }
   }
＊＊＊＊＊＊　ビルド実行結果
----- 07date -----
-- org.bson.Document
doc        =Document{{$and=[Document{{type=A}}, Document{{date=Document{{$gte=Mon Aug 17 16:07:00 JST 2020}}}}, Document{{date2=Document{{$gte=Mon Aug 17 16:07:01 JST 2020}}}}]}}
doc.toJson ={"$and": [{"type": "A"}, {"date": {"$gte": {"$date": 1597648020000}}}, {"date2": {"$gte": {"$date": 1597648021000}}}]}
-- hi.db.hiMongo
node/mson  ={"$and":[{"type":"A"}, {"date":{"$gte":ISODate("2020-08-17T07:07:00.000Z")}}, {"date2":{"$gte":ISODate("2020-08-17T07:07:01.000Z")}}]}
node/json  ={"$and":[{"type":"A"}, {"date":{"$gte":{"$date":1597648020000}}}, {"date2":{"$gte":{"$date":1597648021000}}}]}
---------
doc/Object =(Document){
   (String)"$and"=(ArrayList)[
      (Document){
         (String)"type"=(String)"A"},
      (Document){
         (String)"date"=(Document){
            (String)"$gte"=(Date)Mon Aug 17 16:07:00 JST 2020}},
      (Document){
         (String)"date2"=(Document){
            (String)"$gte"=(Date)Mon Aug 17 16:07:01 JST 2020}}]}
node/Object=(LinkedHashMap){
   (String)"$and"=(ArrayList)[
      (LinkedHashMap){
         (String)"type"=(String)"A"},
      (LinkedHashMap){
         (String)"date"=(LinkedHashMap){
            (String)"$gte"=(Date)Mon Aug 17 16:07:00 JST 2020}},
      (LinkedHashMap){
         (String)"date2"=(LinkedHashMap){
            (String)"$gte"=(Date)Mon Aug 17 16:07:01 JST 2020}}]}
OK
</pre>
<p><input type="button" value="例を隠す△" style="WIDTH:12em"
   onClick="document.getElementById('div_dateQuote2').style.display='none';
            document.getElementById('div_dateQuote1').style.display='block';
            document.location='#div_dateQuote1'"></p>
</div>

<!--
<p class=B1_2 id="regex">
&emsp;正規表現
</p>
<p>
スラッシュで囲めば正規表現と解釈されます。<br>
終端スラッシュの後ろには１文字のオプションが付けられます。
</p>
<pre class=quote10>
db.in("XX").find({name:/BC/i}).... 文字列BC(小文字可)を含む
db.in("XX").find({name:/^B.*n$/}).... Bで始まりnで終わる
db.in("XX").find({name:/(ra|re)/}).... 'ra'または're'を含む
</pre>
<p>
次の表現形を持ちます。
</p>
<p>
<table class=t>
<tr>
<td>型</td>
<td>bson(内部値)</td>
<td>mson表現</td>
<td>json表現</td>
</tr>

<tr>
<td>正規表現</td>
<td>BsonRegularExpression</td>
<td>{$regex:"..",$option:".."}<br>
/.../[.]入力のみ</td>
<td>{$regex:"..",$option:".."}</td>
</tr>

</table>
</p>
<p>
hiMongoでは次の扱いとなります。
</p>

<p>
<table class=t>

<tr>
<td>型</td>
<td>Object(内部値)</td>
<td>mson表現</td>
<td>json表現</td>
</tr>

<tr>
<td>正規表現</td>
<td>BsonRegularExpression</td>
<td>{$regex:"..",$option:".."}<br>
/.../[.]入力のみ</td>
<td>{$regex:"..",$option:".."}</td>
</tr>

</table>
</p>
-->

<p class=B1_2 id="comment">
&emsp;コメント等のhiMongo拡張(hson)
</p>
<p>
標準ではmson記述はコメントを受け付けません。<br>
hiMongo
hiMongo.parseXX(...).asNode()を用いて汎用Objectノードツリー化すればコメントの記述も可能です。<br>
また、hiMongo.parseXX(...).asNodeList()を用いれば複数レコードがただ並ぶだけでJSONの配列形式を採らない記述も受け付けinserManyなどの引数に出来ます。
</p>
<p>
例えば次の記述をinsertManyに与えることが出来ます。
</p>
<pre class=quote8>
// 作曲家リスト
// 出生国と異なる国に移住し活躍した場合はnationalityに
// 出生国,移住国の順で記述
// ご存命の場合はlifeTimeに出生年のみ記述

{famiryName:'Bach',givenName:['Johann','Sebastian'],
 nationality:['独'],lifeTime:[1685,1750]}

{famiryName:'Bartók',givenName:['Béla'],
 nationality:['ハンガリー','米'],lifeTime:[1881,1945]}

{famiryName:'Beethoven',givenName:['Ludwig','van'],
 nationality:['独'],lifeTime:[1770,1827]}

{famiryName:'Brahms',givenName:['Johannes'],
 nationality:['独'],lifeTime:[1833,1897]}

{famiryName:'Chopin',givenName:['Frédéric-Françoic'],
 nationality:['ポーランド','仏'],lifeTime:[1810,1849]}
</pre>
<p>
プログラムの断片を示します。<br>
with_hson()指定をすれば、hson拡張文字列を取り扱えます。
</p>
<pre class=quote10>
//-- with_hson()を発行した上で文字列を直接与える方法
String <span class=blue>_records_json</span>=hiFile.readTextAll("data.json");
hiMongo.DB db=hiMongo.use("db01");
db.in("composer").drop()
  <span class=red>.with_hson()</span>
  .insertMany(<span class=blue>_records_json</span>);
</pre>
<p>
ファイル入力の場合Stringに落とすことなくFileを直接指定することも可能です。
</p>
<pre class=quote10>
//-- with_hson()を発行した上でFile指定
hiMongo.DB db=hiMongo.use("db01");
db.in("composer").drop()
  <span class=red>.with_hson()</span>
  .insertMany(<span class=purple>new File("data.json")</span>);
</pre>
<p>
with_hson()指定を行わず、一旦hiMongo.parseText().adNodeList()でノードレベルまで解析した結果を与えることも出来ます。<br>
</p>
<pre class=quote10>
//-- パーズ結果を使う方法
String <span class=blue>_records_json</span>=hiFile.readTextAll("data.json");
Object <span class=green>_recodes_node</span>=hiMongo.parseText(<span class=blue>_records_json</span>)
                            .asNodeList();
hiMongo.DB db=hiMongo.use("db01");
db.in("composer").drop()
  .insertMany(<span class=green>_recodes_node</span>);
</pre>


<a class=A1 href="#top">top</a>、<a class=A1 href="#API">API</a>
<p class=B1 id="remote">
&emsp;remote接続
</p>
<p>
リモートホストに置かれたデータベースアクセスすることができます。
</p>
<p class=B1_2>
&emsp;リモート側（サーバ側）設定
</p>
<p class=c>
&emsp;外部からのアクセスを許すhost設定
</p>
<p>
リモート側ではmongodb設定でbind_ipにアクセスを許可するhostを指定する必要があります。
</p>
<pre class=quote10>
設定ファイル /etc/mongodb.conf
設定内容     #bind_ip = 127.0.0.1 # コメントアウト
             bind_ip = 0.0.0.0    # 追加
</pre>
<p>
0.0.0.0は全てのホストを許可する指定です。セキュリティを考慮すると、個別hostを記述したほうがよいでしょう。
なおmongoDBのバージョンにより記述法に差があるようです。
</p>
<p class=c>
&emsp;外部からのアクセスを許すユーザ設定
</p>
<p>
アクセスを許すユーザの設定をmongo-shellを使って設定します。<br>
例を示します。ここで指定するDBは利用者設定DBであり、利用者がデータ用に用いるDBとは別です。
</p>
<pre class=quote10>
$ mongo
&gt; use <span class=red>testDB</span>;
&gt; db.createUser({
     user:'<span class=blue>testUser</span>',
     pwd:'<span class=green>xxx</span>',
     roles:[
        {role:'dbOwner',db:'<span class=red>testDB</span>'}
        ]
     });
&gt; exit;
</pre>

<p class=B1_2>
&emsp;クライアント側アクセス
</p>
<p class=c>
&emsp;mongo-shellでアクセス
</p>
<p>
次のような形でサーバとは別のPCからmongo-shellアクセスができます。
</p>
<pre class=quote10>
$ mongo -u <span class=blue>testUser</span> -p <span class=green>xxx</span> --host <i>192.168.1.139</i> <span class=red>testDB</span>
&gt;
</pre>

<p class=c>
&emsp;hiMongoによるJavaプログラムアクセスxxx
</p>
<p>
use()の前にconnect()メソッドにJSON文字列またはhiMongo.RemoteInfoで接続先の情報を指定します。
</p>
<pre class=quote10>
//---- JSON文字列で情報を与える
hiMongo.DB db=hiMongo.connect("{"+
                      "host:'192.168.1.139',"+
                      "port:27017,"+
                      "dbName:'<span class=red>testDB</span>',"+
                      "user:'<span class=blue>testUser</span>',"+
                      "password:'<span class=green>xxx</span>'"+
                      "}")
                    .use("<span class=purple>db01</span>");// 利用者が使うDBはdb01
db.in("coll_01").find()...
</pre>
<p>
または
</p>
<pre class=quote10>
//---- クラス(hiMongo.RemoteInfo)で情報を与える
hiMongo.RemoteInfo _info=new hiMongo.RemoteInfo();
_info.host    = "192.168.1.139";
_info.port    = 27017;
_info.dbName  = "<span class=red>testDB</span>";
_info.user    = "<span class=blue>testUser</span>";
_info.password= "<span class=green>xxx</span>";
hiMongo.DB db=hiMongo.connect(_info)
                     .use("<span class=purple>db01</span>");// 利用者が使うDBはdb01
db.in("coll_01").find()...
</pre>

<a class=A1 href="#top">top</a>、<a class=A1 href="#API">API</a>
<p class=B1 id="worker">
&emsp;Caller(API)とWorker(deiver呼び出し)
</p>
<p>
<a href="../../hi/db/hiMongo.Client.html" title="hi.db内のインタフェース"><code>hiMongo.Client</code></a>～<a href="../../hi/db/hiMongo.Finder.html" title="hi.db内のインタフェース"><code>hiMongo.Finder</code></a>はinterfaceとなっています。
</p>
<p>
２種の実装が用意されています。
</p>
<ul>
<li>直接driverを呼ぶ</li>
<li>APIを受け持つ部分(Caller)とdriverを呼ぶ部分(Worker)を分離して通信で繋ぐ</li>
</ul>
<p>
直接driverを呼ぶ実装は<a href="../../hi/db/hiMongoDirect.html" title="hi.db内のクラス"><code>hiMongoDirect</code></a>で<a href="../../hi/db/hiMongoDirect.Client.html" title="hi.db内のクラス"><code>hiMongoDirect.Client</code></a>～<a href="../../hi/db/hiMongoDirect.Finder.html" title="hi.db内のクラス"><code>hiMongoDirect.Finder</code></a>の実装を持っています。
</p>
<p>
APIを受け持つ部分(Caller)実装は<a href="../../hi/db/hiMongoCaller.html" title="hi.db内のクラス"><code>hiMongoCaller</code></a>で<a href="../../hi/db/hiMongoCaller.Client.html" title="hi.db内のクラス"><code>hiMongoCaller.Client</code></a>～<a href="../../hi/db/hiMongoCaller.Finder.html" title="hi.db内のクラス"><code>hiMongoCaller.Finder</code></a>の実装を持っています。
</p>

<p>
通信機は<a href="../../hi/db/hiStringCOM.html" title="hi.db内のインタフェース"><code>hiStringCOM</code></a>の実装となります。
</p>
<p>
<p>
driverを呼ぶ部分(Worker)実装は<a href="../../hi/db/hiMongoWorker.html" title="hi.db内のクラス"><code>hiMongoWorker</code></a>で通信機<a href="../../hi/db/hiStringCOM.html" title="hi.db内のインタフェース"><code>hiStringCOM</code></a>の実装ともなっています。
</p>
<p>
<a href="../../hi/db/hiMongo.Client.html" title="hi.db内のインタフェース"><code>hiMongo.Client</code></a>,<a href="../../hi/db/hiMongo.DB.html" title="hi.db内のインタフェース"><code>hiMongo.DB</code></a>はhiMongo.connect(),hiMongo.use()で作成されます。<br>
この際引数に<a href="../../hi/db/hiStringCOM.html" title="hi.db内のインタフェース"><code>hiStringCOM</code></a>があると、<a href="../../hi/db/hiMongoCaller.html" title="hi.db内のクラス"><code>hiMongoCaller</code></a>が生成され、なければ<a href="../../hi/db/hiMongoDirect.html" title="hi.db内のクラス"><code>hiMongoDirect</code></a>が生成されます。
</p>
<pre class=quote10>
hiMongo.DB db=hiMongo.use("db01"); // <a href="../../hi/db/hiMongoDirect.html" title="hi.db内のクラス"><code>hiMongoDirect</code></a>となる
//....
hiStringCOM  COM=new hiMonWorkerSample.COM("192.168.1.14",8010); // 通信機(自作クラス)
hiMongo.DB db=hiMongo.use("db01",COM); // <a href="../../hi/db/hiMongoCaller.html" title="hi.db内のクラス"><code>hiMongoCaller</code></a>となる
</pre>
<!--
<p>
なお<a href="../../hi/db/hiMongoWorker.html" title="hi.db内のクラス"><code>hiMongoWorker</code></a>も通信機<a href="../../hi/db/hiStringCOM.html" title="hi.db内のインタフェース"><code>hiStringCOM</code></a>の実装なので次の様に動かすことも出来ます。
</p>
<pre class=quote10>
hiMongoWorker _worker=new hiMongoWorker();
hiMongo.DB db=hiMongo.use("db01",_walker); // <a href="../../hi/db/hiMongoCaller.html" title="hi.db内のクラス"><code>hiMongoCaller</code></a>となる
</pre>
-->
<p>
通信機を用意すればアプリケーションとmongoDB-driverをそれぞれ別の装置で動かすことができ、
例えばアプリケーションはAndoidに置いてDBはWindowsまたはLinuxに置く構成をとることが出来ます。<br>
セキュリティーは通信機の役割となります。
</p>

<a class=A1 href="#top">top</a>、<a class=A1 href="#API">API</a>
<p class=B1 id="build">
&emsp;build
</p>
<div id="divBuild_1">
<p><input type="button" value="説明を表示する" style="WIDTH:10em"
   onClick="document.getElementById('divBuild_2').style.display='block';
            document.getElementById('divBuild_1').style.display='none'"></p>
</div>
<div id="divBuild_2" style="display:none">
<p><input type="button" value="説明を隠す" style="WIDTH:10em"
   onClick="document.getElementById('divBuild_2').style.display='none';
            document.getElementById('divBuild_1').style.display='block'"></p>
<p>
hiMongoを動かすには次のjarをリンクする必要があります。(バージョン番号は変わるかも知れません）
</p>
<table class=t0>
<tr>
<td>hiMongo_0_10.jar</td>
<td>:  hiMongo本体</td>
</tr>
<tr>
<td>hiNote_3_10.jar</td>
<td>:  hiJSON他汎用機能</td>
</tr>
<tr>
<td>mongo-java-driver-3.12.5.jar</td>
<td>:  mongo-java-driver</td>
</tr>
</table>
<p>
これらのjarが../libにあり、プログラムがTest.javaだとすると、次のようにビルド実行出来ます。
</p>
<pre class=prog10>
#!/bin/sh
# 注意！ 改行=LF
MAIN=Test
LIB_DIR=../lib
hiMongoLIB=hiMongo_0_10.jar
hiNoteLIB=hiNote_3_10.jar
mongoLIB=mongo-java-driver-3.12.5.jar
LIBS=".:${LIB_DIR}/${hiNoteLIB}:${LIB_DIR}/${mongoLIB}:${LIB_DIR}/${hiMongoLIB}
# ビルド
javac -Xlint:unchecked -encoding utf-8 -cp ${LIBS} ${MAIN}.java
# 実行
java -cp ${LIBS} ${MAIN}
</pre>
<p><input type="button" value="説明を隠す△" style="WIDTH:10em"
   onClick="document.getElementById('divBuild_2').style.display='none';
            document.getElementById('divBuild_1').style.display='block';
            document.location='#divBuild_1'"></p>
</div>



<a class=A1 href="#top">top</a>、<a class=A1 href="#API">API</a>
<p class=B1 id="log">
&emsp;log
</p>
<div id="divLog_1">
<p><input type="button" value="説明を表示する" style="WIDTH:10em"
   onClick="document.getElementById('divLog_2').style.display='block';
            document.getElementById('divLog_1').style.display='none'"></p>
</div>
<div id="divLog_2" style="display:none">
<p><input type="button" value="説明を隠す" style="WIDTH:10em"
   onClick="document.getElementById('divLog_2').style.display='none';
            document.getElementById('divLog_1').style.display='block'"></p>
<p>
mongo-java-driver-3.12が標準エラーに出すlogの止め方は不明です。
</p>
<p><input type="button" value="説明を隠す△" style="WIDTH:10em"
   onClick="document.getElementById('divLog_2').style.display='none';
            document.getElementById('divLog_1').style.display='block';
            document.location='#divLog_1'"></p>
</div>

<a class=A1 href="#top">top</a>、<a class=A1 href="#API">API</a>
<p class=B1 id="version">
&emsp;更新履歴
</p>
<p class=c>
&emsp;0.05
</p>
<p>
公開初版
</p>

<p class=c>
&emsp;0.06
</p>
<ul>
<li>insertなどの引数として利用者クラスを受けれるようにした</li>
<li>CollenctionにcreateIndex追加</li>
<li>BigDecimal,Decimal128のjson出力を数値とした。入力は関数形,辞書形とも可</li>
<li>closeの方針を変更；Clientのcloseを呼ばない様にサンプルプログラムを変更(ライブラリ自体に変更はない)</li>
<li>javadocのmongo-java-driver参照を3.7から3.12に変更</li>
<li>一部Documentに代わりBsonを引数として受けるようにした（ただし積極的公開ではない）</li>
</ul>

<p class=c>
&emsp;0.07
</p>
<ul>
<li>混乱を防ぐためにメソッド名を型名準拠に変更.
   <ul>
   <li>getNodeListをgetDocumentListに変更</li>
   <li>getIteratorをgetIterableに変更</li>
   </ul>
</li>
<li>形式を揃えるため別名メソッド追加.
   <ul>
   <li>getList()/getDocumentList()の別名</li>
   <li>getList(Class)/getClassList(Class)の別名</li>
   <li>forEachDocument()/forEach()の別名</li>
   <li>forEachClass(Class)/forEach(Class)の別名</li>
   </ul>
</li>
<li>サンプルでのラムダ引数の命名法を統一</li>
<li>JAVADOC記述を修正/強化</li>
</ul>

<p class=c>
&emsp;0.08
</p>
<ul>
<li>出力フォーマット微調整設定をpublicにした<br>
msonで引用符を"にすることもできる</li> <!-- Output format change API enabled -->
<li>
hiMongo拡張JSON文字列(hson)からDocumet,Bson,List&lt;Document&gt;,List&lt;Bson&gt;を得るメソッドをpublicにした
</li>
</ul>
<p>
以下はhiMongo本体の変更ではありませんが、サンプルを含むリリースセットの変更としてここに載せます。
</p>
<ul>
<li>.batによるビルド/試験を追加</li>
<li>.shによる試験でmongo-shell呼び出しをhere_documentからjs参照に変更</li>
<li>javadocオプションに-Xdoclint:none追加(table-captionによるレイアウト乱れを避けるため）</li>
<li>$recordIdへの対処記述を追加</li>
<li>試験での結果ファイルをutf-8化。表示はシステム標準</li>
<li>サンプルで結果をkekka.txt(システム標準)に残すようにした</li>
<li>オツライブラリ/hiNoteを最新版3.10にした</li>
</ul>

<p class=c>
&emsp;0.10
</p>
<p>
hiMongo-APIとdriver呼び出し部を分離し仮想通信機で結ぶことにより、Androidにアプリを置きWindows/LinuxにDBを置く形を可能とした。。
</p>
<ul>
<li>Collection指定をget()からin()に変更</li>
<li>driverインスタンスの参照APIを変数から関数に変更</li>
<li>Client～Finderをinterfaceに変更</li>
<li>旧手続はdriver直呼のhiMongoDirectに移行</li>
<li>通信機interfaceとしてhiStringCOM新設</li>
<li>CallerとWorker新設</li>
<li>hiMongoのconnectとuseでdirect式とcaller式の実装を生成し分ける。<br>
(旧来の呼び出しではdirect型になるのでそのままdirect型で使える)
</li>
<li>サーバ/クライアントのsample(hiMonWorkerSample)新設。binフォルダに起動スクリプト</li>
</ul>

<!-- ======================================================================================= -->
<!-- ======================================================================================= -->
<!-- ======================================================================================= -->
<!-- ======================================================================================= -->
<a class=A1 href="#top">top</a>、<a class=A1 href="#API">API</a>
<p class=B2 id="API">&emsp;ＡＰＩ</p></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>ネストされたクラスのサマリー</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="ネストされたクラスのサマリー表、ネストされたクラスのリストおよび説明">
<caption><span>ネストされたクラス</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">修飾子とタイプ</th>
<th class="colLast" scope="col">クラスと説明</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.Accessor.html" title="hi.db内のインタフェース">hiMongo.Accessor</a></span></code>
<div class="block">レコードアクセス機(Finder,Aggregatorのベース).</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.Aggregator.html" title="hi.db内のインタフェース">hiMongo.Aggregator</a></span></code>
<div class="block">集計器.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.Client.html" title="hi.db内のインタフェース">hiMongo.Client</a></span></code>
<div class="block">mongoDBサーバとの接続を表す.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.Collection.html" title="hi.db内のインタフェース">hiMongo.Collection</a></span></code>
<div class="block">collectionを表す.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.DB.html" title="hi.db内のインタフェース">hiMongo.DB</a></span></code>
<div class="block">database.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.Finder.html" title="hi.db内のインタフェース">hiMongo.Finder</a></span></code>
<div class="block">DB内レコード範囲設定、リスト取得機構.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.MoreMongo.html" title="hi.db内のインタフェース">hiMongo.MoreMongo</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.RemoteInfo.html" title="hi.db内のクラス">hiMongo.RemoteInfo</a></span></code>
<div class="block">接続先情報(connect引数).</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>メソッドのサマリー</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="メソッドのサマリー表、メソッドのリストおよび説明">
<caption><span id="t0" class="activeTableTab"><span>すべてのメソッド</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">staticメソッド</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">concreteメソッド</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">修飾子とタイプ</th>
<th class="colLast" scope="col">メソッドと説明</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static <a href="../../hi/db/hiMongo.Client.html" title="hi.db内のインタフェース">hiMongo.Client</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#connect--">connect</a></span>()</code>
<div class="block">mongo-driver直呼びの接続を得る.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static <a href="../../hi/db/hiMongo.Client.html" title="hi.db内のインタフェース">hiMongo.Client</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#connect-hi.db.hiStringCOM-">connect</a></span>(<a href="../../hi/db/hiStringCOM.html" title="hi.db内のインタフェース">hiStringCOM</a>&nbsp;comm_)</code>
<div class="block">指定通信機を使うCallerによるClientを得る</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>static <a href="../../hi/db/hiMongo.Client.html" title="hi.db内のインタフェース">hiMongo.Client</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#connect-java.lang.Object-">connect</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;remote_)</code>
<div class="block">mongo-driver直呼びの接続を得る.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>static <a href="../../hi/db/hiMongo.Client.html" title="hi.db内のインタフェース">hiMongo.Client</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#connect-java.lang.Object-hi.db.hiStringCOM-">connect</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;remote_,
       <a href="../../hi/db/hiStringCOM.html" title="hi.db内のインタフェース">hiStringCOM</a>&nbsp;comm_)</code>
<div class="block">指定通信機を使うCallerによるClientを得る</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#date--">date</a></span>()</code>
<div class="block">現在時刻の拡張JSON表記を得る.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#engine--">engine</a></span>()</code>
<div class="block">拡張JSON(MSON)解析/表示エンジン取得.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#engineJ--">engineJ</a></span>()</code>
<div class="block">標準JSON表示エンジン取得.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>static <a href="../../hi/db/hiMongo.RemoteInfo.html" title="hi.db内のクラス">hiMongo.RemoteInfo</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#getRemoteInfo-java.lang.Object-">getRemoteInfo</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;remote_)</code>&nbsp;</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#json-java.lang.Object-">json</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;obj_)</code>
<div class="block">標準JSON表記を得る.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#json-java.lang.Object-long-">json</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;obj_,
    long&nbsp;option_)</code>
<div class="block">標準JSON表記を得る.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#mson-java.lang.Object-">mson</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;obj_)</code>
<div class="block">mongo拡張JSON表記を得る.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#mson-java.lang.Object-long-">mson</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;obj_,
    long&nbsp;option_)</code>
<div class="block">mongo拡張JSON表記を得る.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース">Document</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#namedObjToDoc-java.lang.String-java.lang.Object-otsu.hiNote.hiJSON.Engine-">namedObjToDoc</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;name_,
             <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;data_,
             <a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a>&nbsp;engine_)</code>
<div class="block">StringまたはMapオブジェクトから作成されるDocumentを指定名の要素として持つDocumentを得る.
<!</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#nolog--">nolog</a></span>()</code>
<div class="block">mongo-java-driverのログを止める（未）.
<!</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#nolog-java.lang.Class-">nolog</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Class.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Class</a>&lt;?&gt;&nbsp;class_)</code>
<div class="block">mongo-java-driverのログを止める（未）.</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/conversions/Bson.html?is-external=true" title="org.bson.conversions内のクラスまたはインタフェース">Bson</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#objToBson-java.lang.Object-otsu.hiNote.hiJSON.Engine-">objToBson</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;data_,
         <a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a>&nbsp;engine_)</code>
<div class="block">StringまたはMapオブジェクトからDocumentを得る.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース">Document</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#objToDoc-java.lang.Object-otsu.hiNote.hiJSON.Engine-">objToDoc</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;data_,
        <a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a>&nbsp;engine_)</code>
<div class="block">StringまたはMapオブジェクトからDocumentを得る.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#parse-java.io.File-">parse</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/io/File.html?is-external=true" title="java.io内のクラスまたはインタフェース">File</a>&nbsp;textFile_)</code>
<div class="block">パーズするFileを指定.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#parse-java.lang.String-">parse</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;text_)</code>
<div class="block">パーズするテキストを指定.</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/util/List.html?is-external=true" title="java.util内のクラスまたはインタフェース">List</a>&lt;<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/conversions/Bson.html?is-external=true" title="org.bson.conversions内のクラスまたはインタフェース">Bson</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#parseAsBsonList-java.lang.Object-otsu.hiNote.hiJSON.Engine-">parseAsBsonList</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;data_,
               <a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a>&nbsp;engine_)</code>
<div class="block">List&lt;Doument&gt;を得る.</div>
</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/util/List.html?is-external=true" title="java.util内のクラスまたはインタフェース">List</a>&lt;<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース">Document</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#parseAsDocumentList-java.lang.Object-otsu.hiNote.hiJSON.Engine-">parseAsDocumentList</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;data_,
                   <a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a>&nbsp;engine_)</code>
<div class="block">List&lt;Doument&gt;を得る.</div>
</td>
</tr>
<tr id="i21" class="rowColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#parseFile-java.lang.String-">parseFile</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;fileName_)</code>
<div class="block">パーズするテキストファイルをファイル名で指定.</div>
</td>
</tr>
<tr id="i22" class="altColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#parseNode-java.lang.Object-">parseNode</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;obj_)</code>
<div class="block">パーズするノードツリーObjectを指定.</div>
</td>
</tr>
<tr id="i23" class="rowColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#parseText-java.lang.String-">parseText</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;text_)</code>
<div class="block">パーズするテキストを指定.</div>
</td>
</tr>
<tr id="i24" class="altColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/util/ArrayList.html?is-external=true" title="java.util内のクラスまたはインタフェース">ArrayList</a>&lt;<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#show_dbs-boolean-">show_dbs</a></span>(boolean&nbsp;sort_)</code>
<div class="block">mongo-driver直呼び,デフォルト接続でDatabase名一覧を得る.</div>
</td>
</tr>
<tr id="i25" class="rowColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#str-java.lang.Object-">str</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;obj_)</code>
<div class="block">データ構造表示.</div>
</td>
</tr>
<tr id="i26" class="altColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#str-java.lang.Object-long-">str</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;obj_,
   long&nbsp;option_)</code>
<div class="block">データ構造表示.</div>
</td>
</tr>
<tr id="i27" class="rowColor">
<td class="colFirst"><code>static <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#suprress_dot_0-java.lang.String-">suprress_dot_0</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;str_)</code>
<div class="block">数値文字列から.0を削除する.</div>
</td>
</tr>
<tr id="i28" class="altColor">
<td class="colFirst"><code>static <a href="../../hi/db/hiMongo.DB.html" title="hi.db内のインタフェース">hiMongo.DB</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#use-java.lang.String-">use</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;dbName_)</code>
<div class="block">mongo-driver直呼び,デフォルト接続のDBを得る.</div>
</td>
</tr>
<tr id="i29" class="rowColor">
<td class="colFirst"><code>static <a href="../../hi/db/hiMongo.DB.html" title="hi.db内のインタフェース">hiMongo.DB</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#use-java.lang.String-hi.db.hiStringCOM-">use</a></span>(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;dbName_,
   <a href="../../hi/db/hiStringCOM.html" title="hi.db内のインタフェース">hiStringCOM</a>&nbsp;comm_)</code>
<div class="block">指定通信機を使うCallerによるDBを得る</div>
</td>
</tr>
<tr id="i30" class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../hi/db/hiMongo.html#with_hson-boolean-">with_hson</a></span>(boolean&nbsp;use_hson_)</code>
<div class="block">文字列解析にbson/msonでなくhiMongoのhsonを使う.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>クラスから継承されたメソッド&nbsp;java.lang.<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a></h3>
<code><a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="java.lang内のクラスまたはインタフェース">equals</a>, <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="java.lang内のクラスまたはインタフェース">getClass</a>, <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="java.lang内のクラスまたはインタフェース">hashCode</a>, <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="java.lang内のクラスまたはインタフェース">notify</a>, <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="java.lang内のクラスまたはインタフェース">notifyAll</a>, <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true#toString--" title="java.lang内のクラスまたはインタフェース">toString</a>, <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="java.lang内のクラスまたはインタフェース">wait</a>, <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="java.lang内のクラスまたはインタフェース">wait</a>, <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="java.lang内のクラスまたはインタフェース">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>メソッドの詳細</h3>
<a name="connect--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>connect</h4>
<pre>public static&nbsp;<a href="../../hi/db/hiMongo.Client.html" title="hi.db内のインタフェース">hiMongo.Client</a>&nbsp;connect()</pre>
<div class="block">mongo-driver直呼びの接続を得る.</div>
<dl>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>接続</dd>
</dl>
</li>
</ul>
<a name="connect-java.lang.Object-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>connect</h4>
<pre>public static&nbsp;<a href="../../hi/db/hiMongo.Client.html" title="hi.db内のインタフェース">hiMongo.Client</a>&nbsp;connect(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;remote_)</pre>
<div class="block">mongo-driver直呼びの接続を得る.</div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>remote_</code> - 接続情報</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>接続</dd>
</dl>
</li>
</ul>
<a name="use-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>use</h4>
<pre>public static&nbsp;<a href="../../hi/db/hiMongo.DB.html" title="hi.db内のインタフェース">hiMongo.DB</a>&nbsp;use(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;dbName_)</pre>
<div class="block">mongo-driver直呼び,デフォルト接続のDBを得る.</div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>dbName_</code> - Database名</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>Database</dd>
</dl>
</li>
</ul>
<a name="connect-hi.db.hiStringCOM-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>connect</h4>
<pre>public static&nbsp;<a href="../../hi/db/hiMongo.Client.html" title="hi.db内のインタフェース">hiMongo.Client</a>&nbsp;connect(<a href="../../hi/db/hiStringCOM.html" title="hi.db内のインタフェース">hiStringCOM</a>&nbsp;comm_)</pre>
<div class="block">指定通信機を使うCallerによるClientを得る</div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>comm_</code> - 通信機</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>Database</dd>
</dl>
</li>
</ul>
<a name="connect-java.lang.Object-hi.db.hiStringCOM-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>connect</h4>
<pre>public static&nbsp;<a href="../../hi/db/hiMongo.Client.html" title="hi.db内のインタフェース">hiMongo.Client</a>&nbsp;connect(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;remote_,
                                     <a href="../../hi/db/hiStringCOM.html" title="hi.db内のインタフェース">hiStringCOM</a>&nbsp;comm_)</pre>
<div class="block">指定通信機を使うCallerによるClientを得る</div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>remote_</code> - リモートDB情報</dd>
<dd><code>comm_</code> - 通信機</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>Database</dd>
</dl>
</li>
</ul>
<a name="use-java.lang.String-hi.db.hiStringCOM-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>use</h4>
<pre>public static&nbsp;<a href="../../hi/db/hiMongo.DB.html" title="hi.db内のインタフェース">hiMongo.DB</a>&nbsp;use(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;dbName_,
                             <a href="../../hi/db/hiStringCOM.html" title="hi.db内のインタフェース">hiStringCOM</a>&nbsp;comm_)</pre>
<div class="block">指定通信機を使うCallerによるDBを得る</div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>dbName_</code> - Database名</dd>
<dd><code>comm_</code> - 通信機</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>Database</dd>
</dl>
</li>
</ul>
<a name="show_dbs-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>show_dbs</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/util/ArrayList.html?is-external=true" title="java.util内のクラスまたはインタフェース">ArrayList</a>&lt;<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&gt;&nbsp;show_dbs(boolean&nbsp;sort_)</pre>
<div class="block">mongo-driver直呼び,デフォルト接続でDatabase名一覧を得る.</div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>sort_</code> - ソート指定</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>Database名一覧</dd>
</dl>
</li>
</ul>
<a name="getRemoteInfo-java.lang.Object-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRemoteInfo</h4>
<pre>public static&nbsp;<a href="../../hi/db/hiMongo.RemoteInfo.html" title="hi.db内のクラス">hiMongo.RemoteInfo</a>&nbsp;getRemoteInfo(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;remote_)</pre>
</li>
</ul>
<a name="nolog--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nolog</h4>
<pre>public static final&nbsp;void&nbsp;nolog()</pre>
<div class="block">mongo-java-driverのログを止める（未）.
<!-- hiMongo --></div>
</li>
</ul>
<a name="nolog-java.lang.Class-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nolog</h4>
<pre>public static&nbsp;void&nbsp;nolog(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Class.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Class</a>&lt;?&gt;&nbsp;class_)</pre>
<div class="block">mongo-java-driverのログを止める（未）.</div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>class_</code> - クラス（mainのクラス)
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="with_hson-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>with_hson</h4>
<pre>public static&nbsp;void&nbsp;with_hson(boolean&nbsp;use_hson_)</pre>
<div class="block">文字列解析にbson/msonでなくhiMongoのhsonを使う.
<p>
 拡張JSON文字列解析には標準ではorg.bson.Documentが用いられます。<br>
 操作に先立ちstaticメソッドであるhiMongo.with_hson(true)を指定すると以降はhiMongoの解析機構hsonが用いられます。<br>
 hsonではコメントが許されるほか[]で囲まない配列や18桁を超える10進数値をBigDecimalとして解釈することなどが出来ます。
</p>
<p>
このメソッドは全体に影響を与えます。
<a href="../../hi/db/hiMongo.Collection.html#with_hson-boolean-"><code>db.in("xx").with_hson()...</code></a>
を用いれば、それぞれの場所での指定となります。
</p></div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>use_hson_</code> - true:hsonを用いる、false:hsonを用いない
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="parseText-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>parseText</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a>&nbsp;parseText(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;text_)</pre>
<div class="block">パーズするテキストを指定.
<p>
本メソッドの後ろにパーズ形式を指定することでパーズが実行されます。
</p>
<pre class=quote10>
  String  _json_text="....";
  MyClass _data= hiMongo.parseText(_json_text).asClass(MyClass.class);
</pre>
<p>
<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース"><code>Document</code></a>を得るには次のようにします。
</p>
<pre class=quote10>
  String    _json_text="....";
  Document _doc= new Document(hiMongo.parseText(_json_text).asMap());
</pre></div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>text_</code> - テキスト</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>解析エンジン
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="parse-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>parse</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a>&nbsp;parse(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;text_)</pre>
<div class="block">パーズするテキストを指定.
<p>
本メソッドの後ろにパーズ形式を指定することでパーズが実行されます。
</p>
<p>
<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース"><code>Document</code></a>を得るには次のようにします。
</p>
<pre class=quote10>
  String    _json_text="....";
  Document _doc= new Document(hiMongo.parse(_json_text).asMap());
</pre></div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>text_</code> - テキスト</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>解析エンジン
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="parse-java.io.File-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>parse</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a>&nbsp;parse(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/io/File.html?is-external=true" title="java.io内のクラスまたはインタフェース">File</a>&nbsp;textFile_)</pre>
<div class="block">パーズするFileを指定.
<p>
本メソッドの後ろにパーズ形式を指定することでパーズが実行されます。
</p>
<p>
<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース"><code>Document</code></a>を得るには次のようにします。
</p>
<pre class=quote10>
  File     _file= new file("./data.json");
  Document _doc = new Document(hiMongo.parse(_file).asMap());
</pre></div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>textFile_</code> - テキストファイル</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>解析エンジン
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="parseNode-java.lang.Object-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>parseNode</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a>&nbsp;parseNode(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;obj_)</pre>
<div class="block">パーズするノードツリーObjectを指定.
<p>
本メソッドの後ろにパーズ形式を指定することでパーズが実行されます。<br>
他のツール(org.bson.Documentなど）で解析された結果のObjectもパーズできます。
</p>
<pre class=quote10>
  String   _json_text="....";
  Document _doc = Document.parse(_json_text);
  MyClass  _data= hiMongo.parseNode(_doc).asClass(MyClass.class);
</pre></div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>obj_</code> - ノードツリーObject</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>解析エンジン
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="parseFile-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>parseFile</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a>&nbsp;parseFile(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;fileName_)</pre>
<div class="block">パーズするテキストファイルをファイル名で指定.
<p>
本メソッドの後ろにパーズ形式を指定することでパーズが実行されます。
</p>
<pre class=quote10>
  String  _json_file="./data.json";
  MyClass _data= hiMongo.parseFile(_json_file).asClass(MyClass.class);
</pre>
<p>
<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース"><code>Document</code></a>を得るには次のようにします。
</p>
<pre class=quote10>
  String  _json_file="./data.json";
  Document _doc = new Document(hiMongo.parseFile(_file).asMap());
</pre></div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>fileName_</code> - テキストファイル名</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>解析エンジン
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="str-java.lang.Object-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>str</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;str(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;obj_)</pre>
<div class="block">データ構造表示.
<p>
データ構造表示をします。JSON形式ではありません。
</p></div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>obj_</code> - nodeオブジェクト</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>拡張JSON表記
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="str-java.lang.Object-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>str</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;str(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;obj_,
                         long&nbsp;option_)</pre>
<div class="block">データ構造表示.
<p>
データ構造表示をします。JSON形式ではありません。
</p></div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>obj_</code> - nodeオブジェクト</dd>
<dd><code>option_</code> - 表示オプション (hiU.WITH_INDENTなど<a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiFieldFormat.html?is-external=true#option" title="otsu.hiNote内のクラスまたはインタフェース"><code>hiFieldFormatオプション</code></a>参照)</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>拡張JSON表記
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="mson-java.lang.Object-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mson</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;mson(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;obj_)</pre>
<div class="block">mongo拡張JSON表記を得る.
<p>
nodeツリー上にObjectID,Dateクラスインスタンスが有る場合ObjectId(),ISODate()の形で表示します。
</p></div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>obj_</code> - nodeオブジェクト</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>拡張JSON表記
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="mson-java.lang.Object-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mson</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;mson(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;obj_,
                          long&nbsp;option_)</pre>
<div class="block">mongo拡張JSON表記を得る.
<p>
nodeツリー上にObjectID,Dateクラスインスタンスが有る場合ObjectId(),ISODate()の形で表示します。
</p></div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>obj_</code> - nodeオブジェクト</dd>
<dd><code>option_</code> - 表示オプション (hiU.WITH_INDENTなど<a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiFieldFormat.html?is-external=true#option" title="otsu.hiNote内のクラスまたはインタフェース"><code>hiFieldFormatオプション</code></a>参照)</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>拡張JSON表記
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="json-java.lang.Object-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>json</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;json(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;obj_)</pre>
<div class="block">標準JSON表記を得る.
<p>
nodeツリー上にObjectID,Dateクラスインスタンスが有る場合{"$oid":"..."},{"$date":unixEpoch}で表示されます。
</p></div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>obj_</code> - nodeオブジェクト</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>拡張JSON表記
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="json-java.lang.Object-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>json</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;json(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;obj_,
                          long&nbsp;option_)</pre>
<div class="block">標準JSON表記を得る.
<p>
nodeツリー上にObjectID,Dateクラスインスタンスが有る場合{"$oid":"..."},{"$date":unixEpoch}で表示されます。
</p></div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>obj_</code> - nodeオブジェクト</dd>
<dd><code>option_</code> - 表示オプション (hiU.WITH_INDENTなど<a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiFieldFormat.html?is-external=true#option" title="otsu.hiNote内のクラスまたはインタフェース"><code>hiFieldFormatオプション</code></a>参照)</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>拡張JSON表記
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="engine--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>engine</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a>&nbsp;engine()</pre>
<div class="block">拡張JSON(MSON)解析/表示エンジン取得.
<p>
mongoDB用設定が追加されたJSON解析/MSON表示エンジン(clone)を取得します。
</p></div>
<dl>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>エンジン
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="engineJ--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>engineJ</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a>&nbsp;engineJ()</pre>
<div class="block">標準JSON表示エンジン取得.
<p>
標準JSON表示エンジン(clone)を取得します。
</p></div>
<dl>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>エンジン
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="date--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>date</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;date()</pre>
<div class="block">現在時刻の拡張JSON表記を得る.
<p>
次の形式の文字列が得られます。
</p>
<pre class=prog10>
 {$date:<i>Unix-Epoch数値</i>}
 EX. {$date:1597648051506}
</pre></div>
<dl>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>拡張JSON表記
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="suprress_dot_0-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>suprress_dot_0</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;suprress_dot_0(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;str_)</pre>
<div class="block">数値文字列から.0を削除する.
<p>
double値表示の最後の".0"を削除します。
</p>
<pre class=prog10>
 1234.0  -&gt; 1234
 1234.01 -&gt; 1234.01
 a50.0   -&gt; a50
 a50.01  -&gt; a50.01
 a50.0x  -&gt; a50x
 a50.01x -&gt; a50.01x
 a.0     -&gt; a.0
</pre></div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>str_</code> - 数値文字列を含む文字列</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>.0を削除した文字列</dd>
</dl>
</li>
</ul>
<a name="parseAsBsonList-java.lang.Object-otsu.hiNote.hiJSON.Engine-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>parseAsBsonList</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/util/List.html?is-external=true" title="java.util内のクラスまたはインタフェース">List</a>&lt;<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/conversions/Bson.html?is-external=true" title="org.bson.conversions内のクラスまたはインタフェース">Bson</a>&gt;&nbsp;parseAsBsonList(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;data_,
                                         <a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a>&nbsp;engine_)</pre>
<div class="block">List&lt;Doument&gt;を得る.</div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>data_</code> - 拡張JSON文字列、File、List<Document></dd>
<dd><code>engine_</code> - 拡張JSON解析エンジン(nullの場合は用いない)</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>List&lt;Document&gt;
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="parseAsDocumentList-java.lang.Object-otsu.hiNote.hiJSON.Engine-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>parseAsDocumentList</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/util/List.html?is-external=true" title="java.util内のクラスまたはインタフェース">List</a>&lt;<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース">Document</a>&gt;&nbsp;parseAsDocumentList(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;data_,
                                                 <a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a>&nbsp;engine_)</pre>
<div class="block">List&lt;Doument&gt;を得る.</div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>data_</code> - 拡張JSON文字列、File、List<Document></dd>
<dd><code>engine_</code> - 拡張JSON解析エンジン(nullの場合は用いない)</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>List&lt;Document&gt;
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="objToDoc-java.lang.Object-otsu.hiNote.hiJSON.Engine-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>objToDoc</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース">Document</a>&nbsp;objToDoc(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;data_,
                                <a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a>&nbsp;engine_)</pre>
<div class="block">StringまたはMapオブジェクトからDocumentを得る.</div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>data_</code> - 拡張JSON文字列、File、Document</dd>
<dd><code>engine_</code> - 拡張JSON解析エンジン(nullの場合は用いない)</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>Document
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="objToBson-java.lang.Object-otsu.hiNote.hiJSON.Engine-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>objToBson</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/conversions/Bson.html?is-external=true" title="org.bson.conversions内のクラスまたはインタフェース">Bson</a>&nbsp;objToBson(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;data_,
                             <a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a>&nbsp;engine_)</pre>
<div class="block">StringまたはMapオブジェクトからDocumentを得る.</div>
<dl>
<dt><span class="paramLabel">パラメータ:</span></dt>
<dd><code>data_</code> - 拡張JSON文字列、File、Document</dd>
<dd><code>engine_</code> - 拡張JSON解析エンジン(nullの場合は用いない)</dd>
<dt><span class="returnLabel">戻り値:</span></dt>
<dd>Bson
<!-- hiMongo --></dd>
</dl>
</li>
</ul>
<a name="namedObjToDoc-java.lang.String-java.lang.Object-otsu.hiNote.hiJSON.Engine-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>namedObjToDoc</h4>
<pre>public static&nbsp;<a target="_blank" rel="noopener noreferrer" href="http://mongodb.github.io/mongo-java-driver/3.12/javadoc/org/bson/Document.html?is-external=true" title="org.bson内のクラスまたはインタフェース">Document</a>&nbsp;namedObjToDoc(<a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html?is-external=true" title="java.lang内のクラスまたはインタフェース">String</a>&nbsp;name_,
                                     <a target="_blank" rel="noopener noreferrer" href="https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Object.html?is-external=true" title="java.lang内のクラスまたはインタフェース">Object</a>&nbsp;data_,
                                     <a target="_blank" rel="noopener noreferrer" href="http://www.otsu.co.jp/OtsuLibrary/jdoc/otsu/hiNote/hiJSON.Engine.html?is-external=true" title="otsu.hiNote内のクラスまたはインタフェース">hiJSON.Engine</a>&nbsp;engine_)</pre>
<div class="block">StringまたはMapオブジェクトから作成されるDocumentを指定名の要素として持つDocumentを得る.
<!-- hiMongo --></div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="ナビゲーション・リンクをスキップ">ナビゲーション・リンクをスキップ</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="ナビゲーション">
<li><a href="../../hi/db/package-summary.html">パッケージ</a></li>
<li class="navBarCell1Rev">クラス</li>
<li><a href="package-tree.html">階層ツリー</a></li>
<li><a href="../../deprecated-list.html">非推奨</a></li>
<li><a href="../../index-all.html">索引</a></li>
<li><a href="../../help-doc.html">ヘルプ</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>前のクラス</li>
<li><a href="../../hi/db/hiMongo.Accessor.html" title="hi.db内のインタフェース"><span class="typeNameLink">次のクラス</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?hi/db/hiMongo.html" target="_top">フレーム</a></li>
<li><a href="hiMongo.html" target="_top">フレームなし</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses-noframe.html">すべてのクラス</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>サマリー:&nbsp;</li>
<li><a href="#nested.class.summary">ネスト</a>&nbsp;|&nbsp;</li>
<li>フィールド&nbsp;|&nbsp;</li>
<li>コンストラクタ&nbsp;|&nbsp;</li>
<li><a href="#method.summary">メソッド</a></li>
</ul>
<ul class="subNavList">
<li>詳細:&nbsp;</li>
<li>フィールド&nbsp;|&nbsp;</li>
<li>コンストラクタ&nbsp;|&nbsp;</li>
<li><a href="#method.detail">メソッド</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>